
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://haruzova.github.io/eob-pf/LV3/Projects/344-Using-a-Game-Engine/">
      
      
        <link rel="prev" href="../321-Creating-3D-Environments/">
      
      
        <link rel="next" href="../../Research/315-Character-Modelling/">
      
      
      <link rel="icon" href="../../../assets/misc/donspin.gif">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.46">
    
    
      
        <title>344 - Using a Game Engine - Portfolio Site</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="dark" data-md-color-primary="deep-purple" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#344-using-a-game-engine" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Portfolio Site" class="md-header__button md-logo" aria-label="Portfolio Site" data-md-component="logo">
      
  <img src="https://drive.google.com/thumbnail?id=1OaspU3pMMzDgaLhEGvdD4oiczAvKvFOv" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Portfolio Site
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              344 - Using a Game Engine
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="dark" data-md-color-primary="deep-purple" data-md-color-accent="purple"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="light" data-md-color-primary="deep-purple" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../LV2-Units/202-Digital-Games-Production/" class="md-tabs__link">
          
  
  LV2 Units

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../302-Creating-a-Digital-Game/" class="md-tabs__link">
          
  
  LV3

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Portfolio Site" class="md-nav__button md-logo" aria-label="Portfolio Site" data-md-component="logo">
      
  <img src="https://drive.google.com/thumbnail?id=1OaspU3pMMzDgaLhEGvdD4oiczAvKvFOv" alt="logo">

    </a>
    Portfolio Site
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    LV2 Units
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            LV2 Units
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../LV2-Units/202-Digital-Games-Production/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    202 - Digital Games Production
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../LV2-Units/205-Meeting-a-Digital-Media-Brief/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    205 - Meeting a Digital Media Brief
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../LV2-Units/207-Making-a-Website/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    207 - Making a Website
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../LV2-Units/209-Animation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    209 - Animation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../LV2-Units/210-Creating-Digital-Art/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    210 - Creating Digital Art
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../LV2-Units/213-Digital-Audio-Production/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    213 - Digital Audio Production
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../LV2-Units/217-Marketing-and-Promoting-Digital-Media-Products/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    217 - Marketing and Promoting Digital Media Products
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../LV2-Units/222-Careers-in-Creative-Digital-Media/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    222 - Careers in Creative Digital Media
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    LV3
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            LV3
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Projects
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Projects
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../302-Creating-a-Digital-Game/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    302 - Creating a Digital Game
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../315-Character-Modelling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    315 - 3D Character Modelling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../321-Creating-3D-Environments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    321 - Creating 3D Environments
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    344 - Using a Game Engine
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    344 - Using a Game Engine
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#final-product" class="md-nav__link">
    <span class="md-ellipsis">
      Final Product
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#software-assets-used" class="md-nav__link">
    <span class="md-ellipsis">
      Software &amp; assets used
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#self-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Self Evaluation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#devlog" class="md-nav__link">
    <span class="md-ellipsis">
      Devlog
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Devlog">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-scenes-tilemap" class="md-nav__link">
    <span class="md-ellipsis">
      Test scenes &amp; Tilemap
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Test scenes & Tilemap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#181124" class="md-nav__link">
    <span class="md-ellipsis">
      18/11/24
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#player-animations-state-machine" class="md-nav__link">
    <span class="md-ellipsis">
      Player Animations &amp; State Machine
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Player Animations & State Machine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#191124" class="md-nav__link">
    <span class="md-ellipsis">
      19/11/24
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#201124" class="md-nav__link">
    <span class="md-ellipsis">
      20/11/24
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#houses-destructible-objects" class="md-nav__link">
    <span class="md-ellipsis">
      Houses &amp; Destructible Objects
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Houses & Destructible Objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#251124" class="md-nav__link">
    <span class="md-ellipsis">
      25/11/24
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#021224" class="md-nav__link">
    <span class="md-ellipsis">
      02/12/24
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#031224" class="md-nav__link">
    <span class="md-ellipsis">
      03/12/24
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#npcs-pathfinding" class="md-nav__link">
    <span class="md-ellipsis">
      NPCs &amp; Pathfinding
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NPCs & Pathfinding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#041224" class="md-nav__link">
    <span class="md-ellipsis">
      04/12/24
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#091224" class="md-nav__link">
    <span class="md-ellipsis">
      09/12/24
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ui-for-game-mechanics" class="md-nav__link">
    <span class="md-ellipsis">
      UI for Game Mechanics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="UI for Game Mechanics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101224" class="md-nav__link">
    <span class="md-ellipsis">
      10/12/24
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#111224" class="md-nav__link">
    <span class="md-ellipsis">
      11/12/24
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-farming-to-the-farming-sim" class="md-nav__link">
    <span class="md-ellipsis">
      Adding Farming to the Farming Sim
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Adding Farming to the Farming Sim">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#161224" class="md-nav__link">
    <span class="md-ellipsis">
      16/12/24
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#181224" class="md-nav__link">
    <span class="md-ellipsis">
      18/12/24
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#060125" class="md-nav__link">
    <span class="md-ellipsis">
      06/01/25
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#070125" class="md-nav__link">
    <span class="md-ellipsis">
      07/01/25
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#080125" class="md-nav__link">
    <span class="md-ellipsis">
      08/01/25
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#130125" class="md-nav__link">
    <span class="md-ellipsis">
      13/01/25
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#140125" class="md-nav__link">
    <span class="md-ellipsis">
      14/01/25
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#saving-loading" class="md-nav__link">
    <span class="md-ellipsis">
      Saving &amp; Loading
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Saving & Loading">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#150125" class="md-nav__link">
    <span class="md-ellipsis">
      15/01/25
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#200125" class="md-nav__link">
    <span class="md-ellipsis">
      20/01/25
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#210125" class="md-nav__link">
    <span class="md-ellipsis">
      21/01/25
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#220125" class="md-nav__link">
    <span class="md-ellipsis">
      22/01/25
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#270125" class="md-nav__link">
    <span class="md-ellipsis">
      27/01/25
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Research
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Research
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Research/315-Character-Modelling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    315 - Character Modelling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Research/316-Character-Rigging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    316 - Character Rigging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Research/319-Creating-3D-Digital-Animation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    319 - Creating 3D Digital Animation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Research/323-Creating-Audio-for-Digital-Media/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    323 - Creating Audio for Digital Media
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Research/344-Using-A-Game-Engine-R/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    344 - Using A Game Engine
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#final-product" class="md-nav__link">
    <span class="md-ellipsis">
      Final Product
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#software-assets-used" class="md-nav__link">
    <span class="md-ellipsis">
      Software &amp; assets used
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#self-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Self Evaluation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#devlog" class="md-nav__link">
    <span class="md-ellipsis">
      Devlog
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Devlog">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-scenes-tilemap" class="md-nav__link">
    <span class="md-ellipsis">
      Test scenes &amp; Tilemap
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Test scenes & Tilemap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#181124" class="md-nav__link">
    <span class="md-ellipsis">
      18/11/24
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#player-animations-state-machine" class="md-nav__link">
    <span class="md-ellipsis">
      Player Animations &amp; State Machine
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Player Animations & State Machine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#191124" class="md-nav__link">
    <span class="md-ellipsis">
      19/11/24
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#201124" class="md-nav__link">
    <span class="md-ellipsis">
      20/11/24
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#houses-destructible-objects" class="md-nav__link">
    <span class="md-ellipsis">
      Houses &amp; Destructible Objects
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Houses & Destructible Objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#251124" class="md-nav__link">
    <span class="md-ellipsis">
      25/11/24
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#021224" class="md-nav__link">
    <span class="md-ellipsis">
      02/12/24
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#031224" class="md-nav__link">
    <span class="md-ellipsis">
      03/12/24
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#npcs-pathfinding" class="md-nav__link">
    <span class="md-ellipsis">
      NPCs &amp; Pathfinding
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NPCs & Pathfinding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#041224" class="md-nav__link">
    <span class="md-ellipsis">
      04/12/24
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#091224" class="md-nav__link">
    <span class="md-ellipsis">
      09/12/24
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ui-for-game-mechanics" class="md-nav__link">
    <span class="md-ellipsis">
      UI for Game Mechanics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="UI for Game Mechanics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101224" class="md-nav__link">
    <span class="md-ellipsis">
      10/12/24
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#111224" class="md-nav__link">
    <span class="md-ellipsis">
      11/12/24
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-farming-to-the-farming-sim" class="md-nav__link">
    <span class="md-ellipsis">
      Adding Farming to the Farming Sim
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Adding Farming to the Farming Sim">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#161224" class="md-nav__link">
    <span class="md-ellipsis">
      16/12/24
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#181224" class="md-nav__link">
    <span class="md-ellipsis">
      18/12/24
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#060125" class="md-nav__link">
    <span class="md-ellipsis">
      06/01/25
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#070125" class="md-nav__link">
    <span class="md-ellipsis">
      07/01/25
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#080125" class="md-nav__link">
    <span class="md-ellipsis">
      08/01/25
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#130125" class="md-nav__link">
    <span class="md-ellipsis">
      13/01/25
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#140125" class="md-nav__link">
    <span class="md-ellipsis">
      14/01/25
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#saving-loading" class="md-nav__link">
    <span class="md-ellipsis">
      Saving &amp; Loading
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Saving & Loading">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#150125" class="md-nav__link">
    <span class="md-ellipsis">
      15/01/25
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#200125" class="md-nav__link">
    <span class="md-ellipsis">
      20/01/25
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#210125" class="md-nav__link">
    <span class="md-ellipsis">
      21/01/25
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#220125" class="md-nav__link">
    <span class="md-ellipsis">
      22/01/25
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#270125" class="md-nav__link">
    <span class="md-ellipsis">
      27/01/25
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<div><h1 id="344-using-a-game-engine">344 - Using a Game Engine</h1>
<h2 id="final-product">Final Product</h2>
<p><div class="video-container"><iframe src="https://drive.google.com/file/d/1CHvWJf9wxp5L5flG-RdlsD7bMdtc-yGf/preview" style="position:relative;width:100%;height:22.172vw" frameborder="0" allowfullscreen alt="type:video"></iframe></div></p>
<h2 id="software-assets-used">Software &amp; assets used</h2>
<table>
<thead>
<tr>
<th><strong>Game engine:</strong></th>
<th>Godot 4.3</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Sprites &amp; tilemaps:</strong></td>
<td>Sproutlands</td>
</tr>
<tr>
<td><strong>Fonts:</strong></td>
<td>Sproutlands, ZX Palm</td>
</tr>
<tr>
<td><strong>Reference:</strong></td>
<td><a href="https://www.youtube.com/watch?v=it0lsREGdmc&amp;lisYoutubet=PLWTXKdBN8RZe3ytf6qdR4g1JRy0j-93v9">Youtube</a></td>
</tr>
</tbody>
</table>
<h2 id="self-evaluation">Self Evaluation</h2>
<p><strong><em>What is the project you have been working on this term?</em></strong></p>
<blockquote>
<p>Creating a game mechanic for a farming game.</p>
</blockquote>
<p><strong><em>Do you think you successfully did this?</em></strong></p>
<blockquote>
<p>I think so? </p>
</blockquote>
<p><strong><em>What parts of your project do you like?</em></strong></p>
<blockquote>
<p>I like the particle effects nomnomnomnom</p>
</blockquote>
<p><strong><em>What could you improve on, and what part would you do differently next time?</em></strong></p>
<blockquote>
<p>There are still some bugs, like that you can plant crops on top of each other (I attempted to fix it but haven't yet), NPCs started bumping into things again somehow, and that the player's inventory doesn't save correctly. Next time, or in the future, I would like to flesh out the other parts of the game more like adding music &amp; SFX, letting the player place fences using harvested logs to place fences, and have the cows and chickens be able to produce eggs &amp; milk. I wouldn't change how I did the existing parts though (besides bugfixing).</p>
</blockquote>
<p><strong><em>What part of the work did you find the most difficult and why?</em></strong></p>
<blockquote>
<p>I don't remember. I wasn't there.</p>
</blockquote>
<h2 id="devlog">Devlog</h2>
<h3 id="test-scenes-tilemap">Test scenes &amp; Tilemap</h3>
<h5 id="181124">18/11/24</h5>
<p>Starting work on a farming game with a tutorial. There was a project before this but the tutorial was a full major version behind making development super slow (also I didn't like how the mechanics worked) so I did this one instead.</p>
<p>Created a game tilemap using the Sproutlands assets and made a test scene to... test it in, and started learning how to use terrains for things like paths and grass, so they can be dynamically added/"drawn" into the scene which will speed up and simplify level creation somewhat.</p>
<figure>
<p><a class="glightbox" href="https://drive.google.com/thumbnail?id=1bVD0oc5EqaHO0BNeRb_R3EkCkbmY_7ZK&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1bVD0oc5EqaHO0BNeRb_R3EkCkbmY_7ZK&amp;sz=s4000"></a></p>
<figcaption>
<p>Tilemap test scene</p>
</figcaption>
</figure>
<figure>
<p><a class="glightbox" href="https://drive.google.com/thumbnail?id=1dAxDKQovlPeLOop76BL5DRZCoK0hwUzL&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1dAxDKQovlPeLOop76BL5DRZCoK0hwUzL&amp;sz=s4000"></a></p>
<figcaption>
<p>Terrain testing for paths</p>
</figcaption>
</figure>
<h3 id="player-animations-state-machine">Player Animations &amp; State Machine</h3>
<h5 id="191124">19/11/24</h5>
<p>Created a player scene, and added animations for walking, idling, chopping, tilling and watering in 4 directions as well as some collision.</p>
<figure>
<p><a class="glightbox" href="https://drive.google.com/thumbnail?id=1TwTseucj6G6mMkeNhEHJpOjOV_vzVIIG&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1TwTseucj6G6mMkeNhEHJpOjOV_vzVIIG&amp;sz=s4000"></a></p>
<figcaption>
<p>Adding animation frames using the Sproutlands assets</p>
</figcaption>
</figure>
<p>Made a state machine and a class for node states, then used that class to create 5 different states for the player for each action. Currently only walking and idling have transitions into each other, as I haven't added tools yet, and the idle animation keeps defaulting to the front facing one regardless of which way the player should be facing which is weird.</p>
<div class="language-gdscript highlight"><span class="filename">walk_state.gd</span><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_physics_process</span><span class="p">(</span><span class="n">_delta</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">direction</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">Vector2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GameInputEvents</span><span class="o">.</span><span class="n">movement_input</span><span class="p">()</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb nb-Type">Vector2</span><span class="o">.</span><span class="n">UP</span><span class="p">:</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">        </span><span class="n">animated_sprite_2d</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s2">"walk_back"</span><span class="p">)</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb nb-Type">Vector2</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">:</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">        </span><span class="n">animated_sprite_2d</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s2">"walk_right"</span><span class="p">)</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb nb-Type">Vector2</span><span class="o">.</span><span class="n">DOWN</span><span class="p">:</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="w">        </span><span class="n">animated_sprite_2d</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s2">"walk_front"</span><span class="p">)</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb nb-Type">Vector2</span><span class="o">.</span><span class="n">LEFT</span><span class="p">:</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="w">        </span><span class="n">animated_sprite_2d</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s2">"walk_left"</span><span class="p">)</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb nb-Type">Vector2</span><span class="o">.</span><span class="n">ZERO</span><span class="p">:</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="w">        </span><span class="n">player</span><span class="o">.</span><span class="n">player_direction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">direction</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="w">        </span><span class="n">player</span><span class="o">.</span><span class="n">velocity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">speed</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="w">    </span><span class="n">player</span><span class="o">.</span><span class="n">move_and_slide</span><span class="p">()</span>
</span></code></pre></div>
<h5 id="201124">20/11/24</h5>
<p>Found the cause of the animation bug! The <code>idle_state</code> is supposed to get the player's direction from <code>walk_state</code> and act according to that, but I had a line of code that made it set the player's direction during their idle state to match the current movement input, which would obviously be none/null as no actions are being pressed in idle, so it always defaulted to the front-facing animation rather than following the player's actual last direction.</p>
<figure>
<p><a class="glightbox" href="https://drive.google.com/thumbnail?id=1CrowXFbg4PYs_oMf6sLh8VK7n3GYW5Wa&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1CrowXFbg4PYs_oMf6sLh8VK7n3GYW5Wa&amp;sz=s4000"></a></p>
<figcaption>
<p>Staring really hard at <code>idle_state</code> for 2000000 hours to figure out what I messed up (ASMR) </p>
</figcaption>
</figure>
<p>In preparation of implementing the different actions, I added a global script <code>data_types</code> to hold different kinds of game data (useful for things like weapons/tools) and let the player script use it to set their current tool. There's no way to change tools yet, though.</p>
<details class="example">
<summary>Basic tools framework</summary>
<div class="language-gdscript highlight"><span class="filename">data_types.gd</span><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">class_name</span><span class="w"> </span><span class="n">DataTypes</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="k">enum</span><span class="w"> </span><span class="n">Tools</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="n">None</span><span class="p">,</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">    </span><span class="n">AxeWood</span><span class="p">,</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">    </span><span class="n">TillGround</span><span class="p">,</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">    </span><span class="n">WaterCrops</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="p">}</span>
</span></code></pre></div>
<div class="language-gdscript highlight"><span class="filename">player.gd</span><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">current_tool</span><span class="p">:</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">Tools</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">Tools</span><span class="o">.</span><span class="n">None</span>
</span></code></pre></div>
</details>
<p>Further work on the state machine; now the player can transition to chopping, watering or tilling with  <span class="keys"><kbd>Left Click</kbd></span> . I deviated from the tutorial somewhat and added transitions to the <code>walk_state</code> so that you can click while moving to stop and transition into using an action, because I prefer that than having to make sure you're idle before acting; it'll be less annoying for when you're running around watering crops etc.</p>
<p>I had to deal with a bug where the actions would never actually transition back so once you jopped you couldn't stop, as well as the animation bug from yesterday. I didn't take proper notes for some reason so I forgot what the problem was with the first one, but I have a suspicion I forgot this bit of code in the action states:
</p><div class="language-gdscript highlight"><span class="filename">example_action_state.gd</span><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_next_transitions</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="n">animated_sprite_2d</span><span class="o">.</span><span class="n">is_playing</span><span class="p">():</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">        </span><span class="n">transition</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">"Idle"</span><span class="p">)</span>
</span></code></pre></div>
<p><a class="glightbox" href="https://drive.google.com/thumbnail?id=1_O2XWQcHR3tk8JTuPZD9A3zU2NpEAZJz&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1_O2XWQcHR3tk8JTuPZD9A3zU2NpEAZJz&amp;sz=s4000"></a></p>
<details class="example">
<summary>How the state machine scripts function after being fixed</summary>
<div class="language-gdscript highlight"><span class="filename">walk_state.gd</span><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># gets the direction of the player as they walk and sends the result to a variable in player.gd</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_physics_process</span><span class="p">(</span><span class="n">_delta</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="hll"><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">direction</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">Vector2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GameInputEvents</span><span class="o">.</span><span class="n">movement_input</span><span class="p">()</span>
</span></span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb nb-Type">Vector2</span><span class="o">.</span><span class="n">ZERO</span><span class="p">:</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="hll"><span class="w">                </span><span class="n">player</span><span class="o">.</span><span class="n">player_direction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">direction</span>
</span></span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="c1"># checks for when there's no movement input and transitions to idle</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_next_transitions</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="hll"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="n">GameInputEvents</span><span class="o">.</span><span class="n">is_movement_input</span><span class="p">():</span>
</span></span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="hll"><span class="w">        </span><span class="n">transition</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">"Idle"</span><span class="p">)</span>
</span></span></code></pre></div>
<p></p><div class="language-gdscript highlight"><span class="filename">idle_state.gd</span><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1"># reads the direction variable from player.gd and plays the corresponding animation</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_physics_process</span><span class="p">(</span><span class="n">_delta</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">player</span><span class="o">.</span><span class="n">player_direction</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb nb-Type">Vector2</span><span class="o">.</span><span class="n">UP</span><span class="p">:</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">        </span><span class="n">animated_sprite_2d</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s2">"idle_back"</span><span class="p">)</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="n">player</span><span class="o">.</span><span class="n">player_direction</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb nb-Type">Vector2</span><span class="o">.</span><span class="n">DOWN</span><span class="p">:</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">        </span><span class="n">animated_sprite_2d</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s2">"idle_front"</span><span class="p">)</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="n">player</span><span class="o">.</span><span class="n">player_direction</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb nb-Type">Vector2</span><span class="o">.</span><span class="n">LEFT</span><span class="p">:</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">        </span><span class="n">animated_sprite_2d</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s2">"idle_left"</span><span class="p">)</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="n">player</span><span class="o">.</span><span class="n">player_direction</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb nb-Type">Vector2</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">:</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w">        </span><span class="n">animated_sprite_2d</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s2">"idle_right"</span><span class="p">)</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">    </span><span class="k">else</span><span class="p">:</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="w">        </span><span class="n">animated_sprite_2d</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s2">"idle_front"</span><span class="p">)</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="c1"># checks for when there IS movement input and transitions to walking</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_next_transitions</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="w">    </span><span class="n">GameInputEvents</span><span class="o">.</span><span class="n">movement_input</span><span class="p">()</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">GameInputEvents</span><span class="o">.</span><span class="n">is_movement_input</span><span class="p">():</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="w">        </span><span class="n">transition</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">"Walk"</span><span class="p">)</span>
</span></code></pre></div>
The <code>_on_next_transitions</code> function from the template is also how the various actions are handled currently.
<div class="language-gdscript highlight"><span class="filename">idle_state.gd &amp; walk_state.gd</span><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_next_transitions</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span><span class="k">if</span><span class="w">  </span><span class="n">Input</span><span class="o">.</span><span class="n">is_action_just_pressed</span><span class="p">(</span><span class="s2">"hit"</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">player</span><span class="o">.</span><span class="n">current_tool</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">Tools</span><span class="o">.</span><span class="n">AxeWood</span><span class="p">:</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">        </span><span class="n">transition</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">"Jopping"</span><span class="p">)</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="n">Input</span><span class="o">.</span><span class="n">is_action_just_pressed</span><span class="p">(</span><span class="s2">"hit"</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">player</span><span class="o">.</span><span class="n">current_tool</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">Tools</span><span class="o">.</span><span class="n">TillGround</span><span class="p">:</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">        </span><span class="n">transition</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">"Tilling"</span><span class="p">)</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="n">Input</span><span class="o">.</span><span class="n">is_action_just_pressed</span><span class="p">(</span><span class="s2">"hit"</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">player</span><span class="o">.</span><span class="n">current_tool</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">Tools</span><span class="o">.</span><span class="n">WaterCrops</span><span class="p">:</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">        </span><span class="n">transition</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">"Watering"</span><span class="p">)</span>
</span></code></pre></div>
</details>
<h3 id="houses-destructible-objects">Houses &amp; Destructible Objects</h3>
<h5 id="251124">25/11/24</h5>
<figure>
<p>Back to tilemap stuff. Creating multiple different houses, each as their own scene and using a house-specific tileset, before adding them to the main game tileset using scene collections so they can be instantiated and deleted as if they were one tile. 
<a class="glightbox" href="https://drive.google.com/thumbnail?id=1a1CbH7GK-NY303pN0hntPtlluQ9Xgi6f&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1a1CbH7GK-NY303pN0hntPtlluQ9Xgi6f&amp;sz=s4000"></a> 
<a class="glightbox" href="https://drive.google.com/thumbnail?id=1nQr2RCerztyuMW__LrD0VR4OHaP2A6AO&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1nQr2RCerztyuMW__LrD0VR4OHaP2A6AO&amp;sz=s4000"></a></p>
<figcaption>
<p>Adding the new house tileset, with layers for the floor, walls and furniture plus collision for objects and walls</p>
</figcaption>
</figure>
<figure>
<p><a class="glightbox" href="https://drive.google.com/thumbnail?id=1Soja3q8RcjP63-q1Vjh1hCMXh2UQCiqf&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1Soja3q8RcjP63-q1Vjh1hCMXh2UQCiqf&amp;sz=s4000"></a><a class="glightbox" href="https://drive.google.com/thumbnail?id=1AXPkYU4TuQC8F4XTTFFpqld17ac2COhy&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1AXPkYU4TuQC8F4XTTFFpqld17ac2COhy&amp;sz=s4000"></a></p>
<figcaption>
<p>HELL YEAAAAAAAAAAAA</p>
</figcaption>
</figure>
<p>Created doors using the same method of making a separate scene and then adding it to the tileset with scene collections, because they'll need a lot more functionality than a regular tile. They use an animated sprite, with only one animation, because for a smooth opening/closing transition even if the player quickly passes by before it fully opens, it's better to just reverse the animation rather than play a new one.</p>
<p>To make the doors actually functional, they use a component; essentially reusable scenes with scripts that contain a basic function (being collected, growing, taking damage etc) and can more or less just be tossed onto a scene to give it that functionality, then specialised and extended as needed. The component the doors use is an <code>interactable_component</code> that will allow the door to detect when it's being interacted with; in this case, when the player approaches.</p>
<figure>
<p><a class="glightbox" href="https://drive.google.com/thumbnail?id=1nNgjARQw1wc6mQShbGRm6ibrsa7xuar8&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1nNgjARQw1wc6mQShbGRm6ibrsa7xuar8&amp;sz=s4000"></a></p>
<figcaption>
<p>Door scene. Teal box is for detecting the player, pink is for wall collision, and the blue one (hidden under the teal one) is enabled and disabled to let the player in or out.</p>
</figcaption>
</figure>
<p><a class="glightbox" href="https://drive.google.com/thumbnail?id=1il99rECwUD4LCTK-IrKlMwqW3cmPHN8K&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1il99rECwUD4LCTK-IrKlMwqW3cmPHN8K&amp;sz=s4000"></a></p>
<details class="example">
<summary>Door scripts</summary>
<div class="language-gdscript highlight"><span class="filename">interactable_component.gd</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">class_name</span><span class="w"> </span><span class="n">InteractableComponent</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="k">extends</span><span class="w"> </span><span class="n">Area2D</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="k">signal</span><span class="w"> </span><span class="n">interactable_activated</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="k">signal</span><span class="w"> </span><span class="n">interactable_deactivated</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="err">@</span><span class="n">warning_ignore</span><span class="p">(</span><span class="s2">"unused_parameter"</span><span class="p">)</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_body_entered</span><span class="p">(</span><span class="n">body</span><span class="p">:</span><span class="w"> </span><span class="n">Node2D</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">    </span><span class="n">interactable_activated</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="err">@</span><span class="n">warning_ignore</span><span class="p">(</span><span class="s2">"unused_parameter"</span><span class="p">)</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_body_exited</span><span class="p">(</span><span class="n">body</span><span class="p">:</span><span class="w"> </span><span class="n">Node2D</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="w">    </span><span class="n">interactable_deactivated</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
</span></code></pre></div>
<div class="language-gdscript highlight"><span class="filename">door.gd</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="k">extends</span><span class="w"> </span><span class="n">StaticBody2D</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="err">@</span><span class="k">onready</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">animated_sprite_2d</span><span class="p">:</span><span class="w"> </span><span class="n">AnimatedSprite2D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">AnimatedSprite2D</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="err">@</span><span class="k">onready</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">collision_shape_2d</span><span class="p">:</span><span class="w"> </span><span class="n">CollisionShape2D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">CollisionShape2D</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="err">@</span><span class="k">onready</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">interactable_component</span><span class="p">:</span><span class="w"> </span><span class="n">InteractableComponent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">InteractableComponent</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="k">func</span><span class="w"> </span><span class="n">_ready</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="w">    </span><span class="n">interactable_component</span><span class="o">.</span><span class="n">interactable_activated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">on_interactable_activated</span><span class="p">)</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="w">    </span><span class="n">interactable_component</span><span class="o">.</span><span class="n">interactable_deactivated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">on_interactable_deactivated</span><span class="p">)</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="w">    </span><span class="n">collision_shape_2d</span><span class="o">.</span><span class="n">set_deferred</span><span class="p">(</span><span class="s2">"disabled"</span><span class="p">,</span><span class="w"> </span><span class="bp">false</span><span class="p">)</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="k">func</span><span class="w"> </span><span class="n">on_interactable_activated</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="w">    </span><span class="n">animated_sprite_2d</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s2">"open_door"</span><span class="p">)</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="w">    </span><span class="n">collision_shape_2d</span><span class="o">.</span><span class="n">set_deferred</span><span class="p">(</span><span class="s2">"disabled"</span><span class="p">,</span><span class="w"> </span><span class="bp">true</span><span class="p">)</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="k">func</span><span class="w"> </span><span class="n">on_interactable_deactivated</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="w">    </span><span class="n">animated_sprite_2d</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s2">"close_door"</span><span class="p">)</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="w">    </span><span class="n">collision_shape_2d</span><span class="o">.</span><span class="n">set_deferred</span><span class="p">(</span><span class="s2">"disabled"</span><span class="p">,</span><span class="w"> </span><span class="bp">false</span><span class="p">)</span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="w">    </span><span class="nb">print</span><span class="p">(</span><span class="s2">"door deactivated"</span><span class="p">)</span>
</span></code></pre></div>
</details>
<h5 id="021224">02/12/24</h5>
<p>Added some small trees. Since they need to be chopped down and drop items, they're being added to the tileset using scene collections as well. Created a few new components; <code>hit_component</code> and <code>hurt_component</code> for the player and environment/object hitboxes respectively, <code>damage_component</code> for taking/inflicting damage and <code>collectable_component</code> for collectable items. The trees each have their own HP, and the player's actions will now move a hitbox in front of them which can deal damage to objects whose type matches the player's current tool, disappearing at 0 and dropping an item that can be picked up. There is no inventory system yet though, so they just kinda disappear.</p>
<p><a class="glightbox" href="https://drive.google.com/thumbnail?id=1iHszOKQ-Id3-rpyENMZdtV2E3BgexZlq&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1iHszOKQ-Id3-rpyENMZdtV2E3BgexZlq&amp;sz=s4000"></a></p>
<p>LOGCHAMP!!!!!!!! <a class="glightbox" href="https://drive.google.com/thumbnail?id=1iHszOKQ-Id3-rpyENMZdtV2E3BgexZlq&amp;sz=s40" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1iHszOKQ-Id3-rpyENMZdtV2E3BgexZlq&amp;sz=s40"></a><a class="glightbox" href="https://drive.google.com/thumbnail?id=1iHszOKQ-Id3-rpyENMZdtV2E3BgexZlq&amp;sz=s40" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1iHszOKQ-Id3-rpyENMZdtV2E3BgexZlq&amp;sz=s40"></a><a class="glightbox" href="https://drive.google.com/thumbnail?id=1iHszOKQ-Id3-rpyENMZdtV2E3BgexZlq&amp;sz=s40" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1iHszOKQ-Id3-rpyENMZdtV2E3BgexZlq&amp;sz=s40"></a><a class="glightbox" href="https://drive.google.com/thumbnail?id=1iHszOKQ-Id3-rpyENMZdtV2E3BgexZlq&amp;sz=s40" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1iHszOKQ-Id3-rpyENMZdtV2E3BgexZlq&amp;sz=s40"></a><a class="glightbox" href="https://drive.google.com/thumbnail?id=1iHszOKQ-Id3-rpyENMZdtV2E3BgexZlq&amp;sz=s40" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1iHszOKQ-Id3-rpyENMZdtV2E3BgexZlq&amp;sz=s40"></a><a class="glightbox" href="https://drive.google.com/thumbnail?id=1iHszOKQ-Id3-rpyENMZdtV2E3BgexZlq&amp;sz=s40" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1iHszOKQ-Id3-rpyENMZdtV2E3BgexZlq&amp;sz=s40"></a></p>
<p>The <code>hit_component</code> in the player scene is given its area by a small collision shape just for tools that is disabled by default, and each of the action states have been modified slightly to enable this hitbox and move it to the direction of the player. The component script gets the player's current tool, and how much damage they're supposed to deal, each as variables.</p>
<p><a class="glightbox" href="https://drive.google.com/thumbnail?id=1ltQWiIiBw7PSknLWCRIrCwcRykSnTzHa&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1ltQWiIiBw7PSknLWCRIrCwcRykSnTzHa&amp;sz=s4000"></a></p>
<p>The trees likewise have their <code>hurt_component</code> with its own collision shape and a specified tool to look out for; when the <code>hit_component</code> enters the <code>hurt_component</code> with the matching tool selected, it emits a signal containing how much damage the player deals. This signal gets picked up by the <code>damage_component</code> on the trees which handles their HP, and the component decreases their current HP accordingly. Once their HP hits 0, <code>damage_component</code> emits a different signal, and the <code>tree</code> script receives that signal and places a log scene before politely disappearing.</p>
<figure>
<p><a class="glightbox" href="https://drive.google.com/thumbnail?id=1omakKfplls6v4KoK1Veyp1DslNhKyaRG&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1omakKfplls6v4KoK1Veyp1DslNhKyaRG&amp;sz=s4000"></a></p>
<figcaption>
<p>Tree! (purple box is for the hurt components, blue is for basic  collision)</p>
</figcaption>
</figure>
<p>The log is simple, it has a <code>collectable_component</code> with a shape that looks out for the player, and once the player's main hitbox enters that shape, the component kicks the log out of the scene.</p>
<details class="example">
<summary>Component scripts</summary>
<div class="language-gdscript highlight"><span class="filename">hit_component.gd</span><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="k">class_name</span><span class="w"> </span><span class="n">HitComponent</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="k">extends</span><span class="w"> </span><span class="n">Area2D</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">current_tool</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">Tools</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">Tools</span><span class="o">.</span><span class="n">None</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">hit_damage</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
</span></code></pre></div>
<div class="language-gdscript highlight"><span class="filename">hurt_component.gd</span><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">class_name</span><span class="w"> </span><span class="n">HurtComponent</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="k">extends</span><span class="w"> </span><span class="n">Area2D</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="k">tool</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">Tools</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">Tools</span><span class="o">.</span><span class="n">None</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="k">signal</span><span class="w"> </span><span class="n">hurt</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_area_entered</span><span class="p">(</span><span class="n">area</span><span class="p">:</span><span class="w"> </span><span class="n">Area2D</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">hit_component</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">area</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">HitComponent</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="k">tool</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">hit_component</span><span class="o">.</span><span class="n">current_tool</span><span class="p">:</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="w">        </span><span class="n">hurt</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">hit_component</span><span class="o">.</span><span class="n">hit_damage</span><span class="p">)</span>
</span></code></pre></div>
<p></p><div class="language-gdscript highlight"><span class="filename">damage_component.gd</span><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="k">class_name</span><span class="w"> </span><span class="n">DamageComponent</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="k">extends</span><span class="w"> </span><span class="n">Node2D</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">max_damage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">current_damage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="k">signal</span><span class="w"> </span><span class="n">max_damage_reached</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="k">func</span><span class="w"> </span><span class="n">apply_damage</span><span class="p">(</span><span class="n">damage</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w">    </span><span class="n">current_damage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">clamp</span><span class="p">(</span><span class="n">current_damage</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">damage</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">max_damage</span><span class="p">)</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">current_damage</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">max_damage</span><span class="p">:</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="w">        </span><span class="n">max_damage_reached</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
</span></code></pre></div>
<div class="language-gdscript highlight"><span class="filename">collectable_component.gd</span><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="k">class_name</span><span class="w"> </span><span class="n">CollectableComponent</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="k">extends</span><span class="w"> </span><span class="n">Area2D</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">collectable_name</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">String</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_body_entered</span><span class="p">(</span><span class="n">body</span><span class="p">:</span><span class="w"> </span><span class="n">Node2D</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">body</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">Player</span><span class="p">:</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="w">        </span><span class="nb">print</span><span class="p">(</span><span class="s2">"Collected:"</span><span class="p">,</span><span class="w"> </span><span class="n">collectable_name</span><span class="p">)</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="w">        </span><span class="n">get_parent</span><span class="p">()</span><span class="o">.</span><span class="n">queue_free</span><span class="p">()</span>
</span></code></pre></div>
</details>
<h5 id="031224">03/12/24</h5>
<figure>
<p>Added a larger tree with some more HP, as well as a rock that uses all the same components but drop stones instead.
<a class="glightbox" href="https://drive.google.com/thumbnail?id=18w4_IIhEizySahol2f_w1jjpARRxsMsn&amp;sz=s200" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=18w4_IIhEizySahol2f_w1jjpARRxsMsn&amp;sz=s200"></a> <a class="glightbox" href="https://drive.google.com/thumbnail?id=1qud4O9Ml2FVN0mHC6ObeGmkfg-vsxmkQ&amp;sz=s200" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1qud4O9Ml2FVN0mHC6ObeGmkfg-vsxmkQ&amp;sz=s200"></a></p>
<figcaption>
<p>the destructible object brothers</p>
</figcaption>
</figure>
<p>Added an animation to all three destructible objects using shaders. Now when the player hits a tree or rock, they'll shake in response to it. There was a little issue where hitting one of an object would shake all of the others, but just ticking the "local to scene" box on the shaders solves that.</p>
<p><a class="glightbox" href="https://drive.google.com/thumbnail?id=1xa1bjXwRBLl7AU_Ey6qVV-66Qj2Xx-qp&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1xa1bjXwRBLl7AU_Ey6qVV-66Qj2Xx-qp&amp;sz=s4000"></a></p>
<div class="language-gdscript highlight"><span class="filename">shake.gdshader</span><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">shader_type</span><span class="w"> </span><span class="n">canvas_item</span><span class="p">;</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="n">uniform</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="w"> </span><span class="n">shake_intensity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="n">uniform</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="w"> </span><span class="n">shake_speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">20.0</span><span class="p">;</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">vertex</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">Called</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="n">vertex</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">material</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">visible</span><span class="w"> </span><span class="n">on</span><span class="o">.</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="w">    </span><span class="n">vec2</span><span class="w"> </span><span class="n">shake</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vec2</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">VERTEX</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="w">        </span><span class="n">shake</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">TIME</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">shake_speed</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">VERTEX</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">shake_intensity</span><span class="p">;</span>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="w">    </span><span class="n">VERTEX</span><span class="o">.</span><span class="n">xy</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">shake</span><span class="p">;</span>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="npcs-pathfinding">NPCs &amp; Pathfinding</h3>
<h5 id="041224">04/12/24</h5>
<p>Adding Y-sorting to the world and tilemaps. It's just a bunch of ticking Y sort boxes lmao. </p>
<p>Starting work on chicken NPCs with their own animations and state machine similar to the player, with a NavigationAgent2D node that will be used for pathfinding. A NavigationRegion2D in the scene they're in, and on the same navigation layer as them, determines where the chickens are able to path to (defined by a NavigationPolygon), and their state machine should make them cycle between walking around their NavigationPolygon and idling.</p>
<p>Unfortunately, the chickens are currently a bit stupid. They're running into walls, endlessly walking (transition into idle state isn't working yet), bumping into each other, etc and all of them start walking at the same time on game start so they look goofy. </p>
<figure>
<p><a class="glightbox" href="https://drive.google.com/thumbnail?id=1i93vnLBxN65g04oQWFl4yD-cg38IUVMU&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1i93vnLBxN65g04oQWFl4yD-cg38IUVMU&amp;sz=s4000"></a></p>
<figcaption>
<p>chimken</p>
</figcaption>
</figure>
<h5 id="091224">09/12/24</h5>
<p>Fixed the chickens. They now walk around obstacles, properly avoid each other, as their path postprocessing mode is now set to Edgecentered, and the script has been checked over so now they properly cycle between walking and idling, and tweaked so they aren't all in sync anymore so it looks more natural. Using the same framework as the chickens, I added cow NPCs that use a different navigation layer, as well as a terrain for fences that the navigation shapes automatically exclude so nobody tries to path into a fence or anything. This was achieved by adding the fences' tilemap layer to a global group, and setting the NavigationPolygon base (which both NPCs use) to look for tiles in that group and remove their area from the polygon so I don't have to manually do so with every little change in fence layout.</p>
<details class="example">
<summary>Final NPC state machine &amp; Navigation</summary>
<div class="language-gdscript highlight"><span class="filename">chicken.gd</span><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="k">extends</span><span class="w"> </span><span class="n">NonPlayableCharacter</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="c1"># randomises each chicken's number of walk cycles before they start idling</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="k">func</span><span class="w"> </span><span class="n">_ready</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">    </span><span class="n">walk_cycles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">randi_range</span><span class="p">(</span><span class="n">min_walk_cycle</span><span class="p">,</span><span class="w"> </span><span class="n">max_walk_cycle</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-gdscript highlight"><span class="filename">npc_states/idle_state.gd</span><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="k">extends</span><span class="w"> </span><span class="n">NodeState</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">character</span><span class="p">:</span><span class="w"> </span><span class="n">CharacterBody2D</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">animated_sprite_2d</span><span class="p">:</span><span class="w"> </span><span class="n">AnimatedSprite2D</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">idle_state_time_interval</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="err">@</span><span class="k">onready</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">idle_state_timer</span><span class="p">:</span><span class="w"> </span><span class="n">Timer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Timer</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="k">var</span><span class="w"> </span><span class="n">idle_state_timeout</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="c1"># randomises the time each chicken will spend in their idle state and connects the relevant signals</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="k">func</span><span class="w"> </span><span class="n">_ready</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="w">    </span><span class="n">idle_state_timer</span><span class="o">.</span><span class="n">wait_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idle_state_time_interval</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">randf_range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="w">    </span><span class="n">idle_state_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">on_idle_state_timeout</span><span class="p">)</span>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="w">    </span><span class="n">add_child</span><span class="p">(</span><span class="n">idle_state_timer</span><span class="p">)</span>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_process</span><span class="p">(</span><span class="n">_delta</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-15-18"><a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a><span class="w">    </span><span class="k">pass</span>
</span><span id="__span-15-19"><a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a>
</span><span id="__span-15-20"><a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a>
</span><span id="__span-15-21"><a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_physics_process</span><span class="p">(</span><span class="n">_delta</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-15-22"><a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a><span class="w">    </span><span class="k">pass</span>
</span><span id="__span-15-23"><a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a>
</span><span id="__span-15-24"><a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a><span class="c1"># transitions to walking if the timer has ended</span>
</span><span id="__span-15-25"><a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_next_transitions</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-15-26"><a id="__codelineno-15-26" name="__codelineno-15-26" href="#__codelineno-15-26"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">idle_state_timeout</span><span class="p">:</span>
</span><span id="__span-15-27"><a id="__codelineno-15-27" name="__codelineno-15-27" href="#__codelineno-15-27"></a><span class="w">        </span><span class="n">transition</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">"Walk"</span><span class="p">)</span>
</span><span id="__span-15-28"><a id="__codelineno-15-28" name="__codelineno-15-28" href="#__codelineno-15-28"></a>
</span><span id="__span-15-29"><a id="__codelineno-15-29" name="__codelineno-15-29" href="#__codelineno-15-29"></a>
</span><span id="__span-15-30"><a id="__codelineno-15-30" name="__codelineno-15-30" href="#__codelineno-15-30"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_enter</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-15-31"><a id="__codelineno-15-31" name="__codelineno-15-31" href="#__codelineno-15-31"></a><span class="w">    </span><span class="n">animated_sprite_2d</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s2">"Idle"</span><span class="p">)</span>
</span><span id="__span-15-32"><a id="__codelineno-15-32" name="__codelineno-15-32" href="#__codelineno-15-32"></a>
</span><span id="__span-15-33"><a id="__codelineno-15-33" name="__codelineno-15-33" href="#__codelineno-15-33"></a><span class="w">    </span><span class="n">idle_state_timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span>
</span><span id="__span-15-34"><a id="__codelineno-15-34" name="__codelineno-15-34" href="#__codelineno-15-34"></a><span class="w">    </span><span class="n">idle_state_timer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="__span-15-35"><a id="__codelineno-15-35" name="__codelineno-15-35" href="#__codelineno-15-35"></a>
</span><span id="__span-15-36"><a id="__codelineno-15-36" name="__codelineno-15-36" href="#__codelineno-15-36"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_exit</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-15-37"><a id="__codelineno-15-37" name="__codelineno-15-37" href="#__codelineno-15-37"></a><span class="w">    </span><span class="n">animated_sprite_2d</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</span><span id="__span-15-38"><a id="__codelineno-15-38" name="__codelineno-15-38" href="#__codelineno-15-38"></a><span class="w">    </span><span class="n">idle_state_timer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</span><span id="__span-15-39"><a id="__codelineno-15-39" name="__codelineno-15-39" href="#__codelineno-15-39"></a>
</span><span id="__span-15-40"><a id="__codelineno-15-40" name="__codelineno-15-40" href="#__codelineno-15-40"></a><span class="c1"># changes a variable when the idle timer is finished</span>
</span><span id="__span-15-41"><a id="__codelineno-15-41" name="__codelineno-15-41" href="#__codelineno-15-41"></a><span class="k">func</span><span class="w"> </span><span class="n">on_idle_state_timeout</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-15-42"><a id="__codelineno-15-42" name="__codelineno-15-42" href="#__codelineno-15-42"></a><span class="w">    </span><span class="n">idle_state_timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span>
</span></code></pre></div>
<div class="language-gdscript highlight"><span class="filename">npc_states/walk_state.gd</span><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="k">extends</span><span class="w"> </span><span class="n">NodeState</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">character</span><span class="p">:</span><span class="w"> </span><span class="n">NonPlayableCharacter</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">animated_sprite_2d</span><span class="p">:</span><span class="w"> </span><span class="n">AnimatedSprite2D</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">navigation_agent_2d</span><span class="p">:</span><span class="w"> </span><span class="n">NavigationAgent2D</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">min_speed</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10.0</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">max_speed</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">20.0</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="k">var</span><span class="w"> </span><span class="n">speed</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">float</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="c1"># sets up any signal-function connections and moves to character setup</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="k">func</span><span class="w"> </span><span class="n">_ready</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="w">    </span><span class="n">navigation_agent_2d</span><span class="o">.</span><span class="n">velocity_computed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">on_safe_velocity_computed</span><span class="p">)</span>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="w">    </span><span class="n">call_deferred</span><span class="p">(</span><span class="s2">"character_setup"</span><span class="p">)</span>
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a>
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a><span class="k">func</span><span class="w"> </span><span class="n">character_setup</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a><span class="w">    </span><span class="n">await</span><span class="w"> </span><span class="n">get_tree</span><span class="p">()</span><span class="o">.</span><span class="n">physics_frame</span>
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a>
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a><span class="w">    </span><span class="n">set_movement_target</span><span class="p">()</span>
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a>
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a><span class="c1"># sets the movement target to a reasonable location and sets the character's speed to be slightly randomised</span>
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a><span class="k">func</span><span class="w"> </span><span class="n">set_movement_target</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">target_position</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">Vector2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NavigationServer2D</span><span class="o">.</span><span class="n">map_get_random_point</span><span class="p">(</span><span class="n">navigation_agent_2d</span><span class="o">.</span><span class="n">get_navigation_map</span><span class="p">(),</span><span class="w"> </span><span class="n">navigation_agent_2d</span><span class="o">.</span><span class="n">navigation_layers</span><span class="p">,</span><span class="w"> </span><span class="bp">false</span><span class="p">)</span>
</span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a><span class="w">    </span><span class="n">navigation_agent_2d</span><span class="o">.</span><span class="n">target_position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">target_position</span>
</span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a><span class="w">    </span><span class="n">speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">randf_range</span><span class="p">(</span><span class="n">min_speed</span><span class="p">,</span><span class="w"> </span><span class="n">max_speed</span><span class="p">)</span>
</span><span id="__span-16-27"><a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a>
</span><span id="__span-16-28"><a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a>
</span><span id="__span-16-29"><a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_process</span><span class="p">(</span><span class="n">_delta</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-16-30"><a id="__codelineno-16-30" name="__codelineno-16-30" href="#__codelineno-16-30"></a><span class="w">    </span><span class="k">pass</span>
</span><span id="__span-16-31"><a id="__codelineno-16-31" name="__codelineno-16-31" href="#__codelineno-16-31"></a>
</span><span id="__span-16-32"><a id="__codelineno-16-32" name="__codelineno-16-32" href="#__codelineno-16-32"></a><span class="c1"># counts when the character finishes a walk cycle and sets a new movement target</span>
</span><span id="__span-16-33"><a id="__codelineno-16-33" name="__codelineno-16-33" href="#__codelineno-16-33"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_physics_process</span><span class="p">(</span><span class="n">_delta</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-16-34"><a id="__codelineno-16-34" name="__codelineno-16-34" href="#__codelineno-16-34"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">navigation_agent_2d</span><span class="o">.</span><span class="n">is_navigation_finished</span><span class="p">():</span>
</span><span id="__span-16-35"><a id="__codelineno-16-35" name="__codelineno-16-35" href="#__codelineno-16-35"></a><span class="w">        </span><span class="n">character</span><span class="o">.</span><span class="n">current_walk_cycle</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-16-36"><a id="__codelineno-16-36" name="__codelineno-16-36" href="#__codelineno-16-36"></a><span class="w">        </span><span class="n">set_movement_target</span><span class="p">()</span>
</span><span id="__span-16-37"><a id="__codelineno-16-37" name="__codelineno-16-37" href="#__codelineno-16-37"></a><span class="w">        </span><span class="k">return</span>
</span><span id="__span-16-38"><a id="__codelineno-16-38" name="__codelineno-16-38" href="#__codelineno-16-38"></a>
</span><span id="__span-16-39"><a id="__codelineno-16-39" name="__codelineno-16-39" href="#__codelineno-16-39"></a><span class="w">    </span><span class="c1">#flips the character sprite based on where they're heading relative to their location</span>
</span><span id="__span-16-40"><a id="__codelineno-16-40" name="__codelineno-16-40" href="#__codelineno-16-40"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">target_position</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">Vector2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">navigation_agent_2d</span><span class="o">.</span><span class="n">get_next_path_position</span><span class="p">()</span>
</span><span id="__span-16-41"><a id="__codelineno-16-41" name="__codelineno-16-41" href="#__codelineno-16-41"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">target_direction</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">Vector2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">character</span><span class="o">.</span><span class="n">global_position</span><span class="o">.</span><span class="n">direction_to</span><span class="p">(</span><span class="n">target_position</span><span class="p">)</span>
</span><span id="__span-16-42"><a id="__codelineno-16-42" name="__codelineno-16-42" href="#__codelineno-16-42"></a><span class="w">    </span><span class="n">animated_sprite_2d</span><span class="o">.</span><span class="n">flip_h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">target_direction</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span>
</span><span id="__span-16-43"><a id="__codelineno-16-43" name="__codelineno-16-43" href="#__codelineno-16-43"></a>
</span><span id="__span-16-44"><a id="__codelineno-16-44" name="__codelineno-16-44" href="#__codelineno-16-44"></a><span class="w">    </span><span class="c1"># handles character movement</span>
</span><span id="__span-16-45"><a id="__codelineno-16-45" name="__codelineno-16-45" href="#__codelineno-16-45"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">velocity</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">Vector2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">target_direction</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">speed</span>
</span><span id="__span-16-46"><a id="__codelineno-16-46" name="__codelineno-16-46" href="#__codelineno-16-46"></a>
</span><span id="__span-16-47"><a id="__codelineno-16-47" name="__codelineno-16-47" href="#__codelineno-16-47"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">navigation_agent_2d</span><span class="o">.</span><span class="n">avoidance_enabled</span><span class="p">:</span>
</span><span id="__span-16-48"><a id="__codelineno-16-48" name="__codelineno-16-48" href="#__codelineno-16-48"></a><span class="w">        </span><span class="n">navigation_agent_2d</span><span class="o">.</span><span class="n">velocity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">velocity</span>
</span><span id="__span-16-49"><a id="__codelineno-16-49" name="__codelineno-16-49" href="#__codelineno-16-49"></a><span class="w">    </span><span class="k">else</span><span class="p">:</span>
</span><span id="__span-16-50"><a id="__codelineno-16-50" name="__codelineno-16-50" href="#__codelineno-16-50"></a><span class="w">        </span><span class="n">character</span><span class="o">.</span><span class="n">velocity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">target_direction</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">speed</span>
</span><span id="__span-16-51"><a id="__codelineno-16-51" name="__codelineno-16-51" href="#__codelineno-16-51"></a><span class="w">        </span><span class="n">character</span><span class="o">.</span><span class="n">move_and_slide</span><span class="p">()</span>
</span><span id="__span-16-52"><a id="__codelineno-16-52" name="__codelineno-16-52" href="#__codelineno-16-52"></a>
</span><span id="__span-16-53"><a id="__codelineno-16-53" name="__codelineno-16-53" href="#__codelineno-16-53"></a>
</span><span id="__span-16-54"><a id="__codelineno-16-54" name="__codelineno-16-54" href="#__codelineno-16-54"></a><span class="k">func</span><span class="w"> </span><span class="n">on_safe_velocity_computed</span><span class="p">(</span><span class="n">safe_velocity</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">Vector2</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-16-55"><a id="__codelineno-16-55" name="__codelineno-16-55" href="#__codelineno-16-55"></a><span class="w">    </span><span class="n">character</span><span class="o">.</span><span class="n">velocity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">safe_velocity</span>
</span><span id="__span-16-56"><a id="__codelineno-16-56" name="__codelineno-16-56" href="#__codelineno-16-56"></a><span class="w">    </span><span class="n">character</span><span class="o">.</span><span class="n">move_and_slide</span><span class="p">()</span>
</span><span id="__span-16-57"><a id="__codelineno-16-57" name="__codelineno-16-57" href="#__codelineno-16-57"></a>
</span><span id="__span-16-58"><a id="__codelineno-16-58" name="__codelineno-16-58" href="#__codelineno-16-58"></a><span class="c1"># transitions to idle when the number of walk cycles is reached</span>
</span><span id="__span-16-59"><a id="__codelineno-16-59" name="__codelineno-16-59" href="#__codelineno-16-59"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_next_transitions</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-16-60"><a id="__codelineno-16-60" name="__codelineno-16-60" href="#__codelineno-16-60"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">character</span><span class="o">.</span><span class="n">current_walk_cycle</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">character</span><span class="o">.</span><span class="n">walk_cycles</span><span class="p">:</span>
</span><span id="__span-16-61"><a id="__codelineno-16-61" name="__codelineno-16-61" href="#__codelineno-16-61"></a><span class="w">        </span><span class="n">character</span><span class="o">.</span><span class="n">velocity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">Vector2</span><span class="o">.</span><span class="n">ZERO</span>
</span><span id="__span-16-62"><a id="__codelineno-16-62" name="__codelineno-16-62" href="#__codelineno-16-62"></a><span class="w">        </span><span class="n">transition</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">"Idle"</span><span class="p">)</span>
</span><span id="__span-16-63"><a id="__codelineno-16-63" name="__codelineno-16-63" href="#__codelineno-16-63"></a>
</span><span id="__span-16-64"><a id="__codelineno-16-64" name="__codelineno-16-64" href="#__codelineno-16-64"></a>
</span><span id="__span-16-65"><a id="__codelineno-16-65" name="__codelineno-16-65" href="#__codelineno-16-65"></a><span class="c1"># resets the current walk cycles to 0 when re-entering the state</span>
</span><span id="__span-16-66"><a id="__codelineno-16-66" name="__codelineno-16-66" href="#__codelineno-16-66"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_enter</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-16-67"><a id="__codelineno-16-67" name="__codelineno-16-67" href="#__codelineno-16-67"></a><span class="w">    </span><span class="n">animated_sprite_2d</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s2">"Walk"</span><span class="p">)</span>
</span><span id="__span-16-68"><a id="__codelineno-16-68" name="__codelineno-16-68" href="#__codelineno-16-68"></a><span class="w">    </span><span class="n">character</span><span class="o">.</span><span class="n">current_walk_cycle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
</span><span id="__span-16-69"><a id="__codelineno-16-69" name="__codelineno-16-69" href="#__codelineno-16-69"></a>
</span><span id="__span-16-70"><a id="__codelineno-16-70" name="__codelineno-16-70" href="#__codelineno-16-70"></a>
</span><span id="__span-16-71"><a id="__codelineno-16-71" name="__codelineno-16-71" href="#__codelineno-16-71"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_exit</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-16-72"><a id="__codelineno-16-72" name="__codelineno-16-72" href="#__codelineno-16-72"></a><span class="w">    </span><span class="n">animated_sprite_2d</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</span></code></pre></div>
</details>
<figure>
<p><a class="glightbox" href="https://drive.google.com/thumbnail?id=1MILDF-gyXvvLqTZi_sIRjZhFIU6Jhfji&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1MILDF-gyXvvLqTZi_sIRjZhFIU6Jhfji&amp;sz=s4000"></a></p>
<figcaption>
<p>Chickens navigation, note how the shape automatically avoids fence tiles and the chicken paths filter through the only exit to get out, rather than just walking into the fences.</p>
</figcaption>
</figure>
<h3 id="ui-for-game-mechanics">UI for Game Mechanics</h3>
<h5 id="101224">10/12/24</h5>
<p>Tweaked the cows a little to make them a little less active than chickens, now moving on to the game UI. Added a toolbar that lets the player equip the different tools, and an inventory bar that displays all the items and their count. The UI elements are styled by a game theme, with different custom "types" for the various types of elements, so all the tool buttons can be edited at once or have specific overrides.</p>
<p>Also added new collectibles like milk, eggs, wheat, tomatoes, and seeds using the same collectable component I made the rocks and logs from :)</p>
<figure>
<p><a class="glightbox" href="https://drive.google.com/thumbnail?id=15XK9KSBh2L_a_eiiunr4ivHg5pClyyQq&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=15XK9KSBh2L_a_eiiunr4ivHg5pClyyQq&amp;sz=s4000"></a></p>
<figcaption>
<p>Themed inventory/tool bars</p>
</figcaption>
</figure>
<figure>
<p><a class="glightbox" href="https://drive.google.com/thumbnail?id=1iKMa8AdiWGfcbtE8wRAOEQz6FBrlWR3e&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1iKMa8AdiWGfcbtE8wRAOEQz6FBrlWR3e&amp;sz=s4000"></a></p>
<figcaption>
<p>Collectable items currently in the game</p>
</figcaption>
</figure>
<h5 id="111224">11/12/24</h5>
<p>Finishing the inventory panel by adding custom fonts and item counters, then finally making collectables do something with the use of a global script that manages the inventory and modifying the collectable component so it adds items. I'll go over the scripts later, as they get a small rework pretty soon.</p>
<figure>
<p>Adding a time mechanism along with new panels showing the current day and time, with some speed options so you can speed up the day. There was an issue where the time didn't update because I forgot to actually use the recalculate_time() function so it... never recalculated the time. Mindblowing.
<a class="glightbox" href="https://drive.google.com/thumbnail?id=1ZxpYGwOGj-OcCIoefqAYxdQrVQn-Q0lX&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1ZxpYGwOGj-OcCIoefqAYxdQrVQn-Q0lX&amp;sz=s4000"></a></p>
<figcaption>
<p>Day/time UI</p>
</figcaption>
</figure>
<details class="example">
<summary>Time &amp; Date scripts</summary>
<p></p><div class="language-gdscript highlight"><span class="filename">day_and_night_cycle_manager.gd</span><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="k">extends</span><span class="w"> </span><span class="n">Node</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="c1"># maths. if i explain this further i think i might throw up sorry</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="k">const</span><span class="w"> </span><span class="n">MINUTES_PER_DAY</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">60</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="k">const</span><span class="w"> </span><span class="n">MINUTES_PER_HOUR</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">60</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="k">const</span><span class="w"> </span><span class="n">GAME_MINUTE_DURATION</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">TAU</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">MINUTES_PER_DAY</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="k">var</span><span class="w"> </span><span class="n">game_speed</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.0</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="k">var</span><span class="w"> </span><span class="n">initial_day</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a><span class="k">var</span><span class="w"> </span><span class="n">initial_hour</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span>
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a><span class="k">var</span><span class="w"> </span><span class="n">initial_minute</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">30</span>
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>
</span><span id="__span-17-14"><a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a><span class="k">var</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span>
</span><span id="__span-17-15"><a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a><span class="k">var</span><span class="w"> </span><span class="n">current_minute</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
</span><span id="__span-17-16"><a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a><span class="k">var</span><span class="w"> </span><span class="n">current_day</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
</span><span id="__span-17-17"><a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a>
</span><span id="__span-17-18"><a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a><span class="k">signal</span><span class="w"> </span><span class="n">game_time</span><span class="p">(</span><span class="n">time</span><span class="p">:</span><span class="nb nb-Type">float</span><span class="p">)</span>
</span><span id="__span-17-19"><a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a><span class="k">signal</span><span class="w"> </span><span class="n">time_tick</span><span class="p">(</span><span class="n">day</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">,</span><span class="w"> </span><span class="n">hour</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">,</span><span class="w"> </span><span class="n">minute</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">)</span>
</span><span id="__span-17-20"><a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a><span class="k">signal</span><span class="w"> </span><span class="n">time_tick_day</span><span class="p">(</span><span class="n">day</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">)</span>
</span><span id="__span-17-21"><a id="__codelineno-17-21" name="__codelineno-17-21" href="#__codelineno-17-21"></a>
</span><span id="__span-17-22"><a id="__codelineno-17-22" name="__codelineno-17-22" href="#__codelineno-17-22"></a><span class="k">func</span><span class="w"> </span><span class="n">_ready</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-17-23"><a id="__codelineno-17-23" name="__codelineno-17-23" href="#__codelineno-17-23"></a><span class="w">    </span><span class="n">set_initial_time</span><span class="p">()</span>
</span><span id="__span-17-24"><a id="__codelineno-17-24" name="__codelineno-17-24" href="#__codelineno-17-24"></a>
</span><span id="__span-17-25"><a id="__codelineno-17-25" name="__codelineno-17-25" href="#__codelineno-17-25"></a>
</span><span id="__span-17-26"><a id="__codelineno-17-26" name="__codelineno-17-26" href="#__codelineno-17-26"></a><span class="k">func</span><span class="w"> </span><span class="n">_process</span><span class="p">(</span><span class="n">delta</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-17-27"><a id="__codelineno-17-27" name="__codelineno-17-27" href="#__codelineno-17-27"></a><span class="w">    </span><span class="n">time</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">delta</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">game_speed</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">GAME_MINUTE_DURATION</span>
</span><span id="__span-17-28"><a id="__codelineno-17-28" name="__codelineno-17-28" href="#__codelineno-17-28"></a><span class="w">    </span><span class="n">game_time</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
</span><span id="__span-17-29"><a id="__codelineno-17-29" name="__codelineno-17-29" href="#__codelineno-17-29"></a>
</span><span id="__span-17-30"><a id="__codelineno-17-30" name="__codelineno-17-30" href="#__codelineno-17-30"></a><span class="w">    </span><span class="n">recalculate_time</span><span class="p">()</span>
</span><span id="__span-17-31"><a id="__codelineno-17-31" name="__codelineno-17-31" href="#__codelineno-17-31"></a>
</span><span id="__span-17-32"><a id="__codelineno-17-32" name="__codelineno-17-32" href="#__codelineno-17-32"></a><span class="k">func</span><span class="w"> </span><span class="n">set_initial_time</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-17-33"><a id="__codelineno-17-33" name="__codelineno-17-33" href="#__codelineno-17-33"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">initial_total_minutes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">initial_day</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">MINUTES_PER_DAY</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">initial_hour</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">MINUTES_PER_HOUR</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">initial_minute</span>
</span><span id="__span-17-34"><a id="__codelineno-17-34" name="__codelineno-17-34" href="#__codelineno-17-34"></a>
</span><span id="__span-17-35"><a id="__codelineno-17-35" name="__codelineno-17-35" href="#__codelineno-17-35"></a><span class="w">    </span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">initial_total_minutes</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">GAME_MINUTE_DURATION</span>
</span><span id="__span-17-36"><a id="__codelineno-17-36" name="__codelineno-17-36" href="#__codelineno-17-36"></a>
</span><span id="__span-17-37"><a id="__codelineno-17-37" name="__codelineno-17-37" href="#__codelineno-17-37"></a><span class="k">func</span><span class="w"> </span><span class="n">recalculate_time</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-17-38"><a id="__codelineno-17-38" name="__codelineno-17-38" href="#__codelineno-17-38"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">total_minutes</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">GAME_MINUTE_DURATION</span><span class="p">)</span>
</span><span id="__span-17-39"><a id="__codelineno-17-39" name="__codelineno-17-39" href="#__codelineno-17-39"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">day</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">(</span><span class="n">total_minutes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">MINUTES_PER_DAY</span><span class="p">)</span>
</span><span id="__span-17-40"><a id="__codelineno-17-40" name="__codelineno-17-40" href="#__codelineno-17-40"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">current_day_minutes</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">total_minutes</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">MINUTES_PER_DAY</span>
</span><span id="__span-17-41"><a id="__codelineno-17-41" name="__codelineno-17-41" href="#__codelineno-17-41"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">hour</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">(</span><span class="n">current_day_minutes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">MINUTES_PER_HOUR</span><span class="p">)</span>
</span><span id="__span-17-42"><a id="__codelineno-17-42" name="__codelineno-17-42" href="#__codelineno-17-42"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">minute</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">(</span><span class="n">current_day_minutes</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">MINUTES_PER_HOUR</span><span class="p">)</span>
</span><span id="__span-17-43"><a id="__codelineno-17-43" name="__codelineno-17-43" href="#__codelineno-17-43"></a>
</span><span id="__span-17-44"><a id="__codelineno-17-44" name="__codelineno-17-44" href="#__codelineno-17-44"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">current_minute</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">minute</span><span class="p">:</span><span class="w"> </span>
</span><span id="__span-17-45"><a id="__codelineno-17-45" name="__codelineno-17-45" href="#__codelineno-17-45"></a><span class="w">        </span><span class="n">current_minute</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">minute</span>
</span><span id="__span-17-46"><a id="__codelineno-17-46" name="__codelineno-17-46" href="#__codelineno-17-46"></a><span class="w">        </span><span class="n">time_tick</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">day</span><span class="p">,</span><span class="w"> </span><span class="n">hour</span><span class="p">,</span><span class="w"> </span><span class="n">minute</span><span class="p">)</span>
</span><span id="__span-17-47"><a id="__codelineno-17-47" name="__codelineno-17-47" href="#__codelineno-17-47"></a>
</span><span id="__span-17-48"><a id="__codelineno-17-48" name="__codelineno-17-48" href="#__codelineno-17-48"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">current_day</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">day</span><span class="p">:</span>
</span><span id="__span-17-49"><a id="__codelineno-17-49" name="__codelineno-17-49" href="#__codelineno-17-49"></a><span class="w">        </span><span class="n">current_day</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">day</span>
</span><span id="__span-17-50"><a id="__codelineno-17-50" name="__codelineno-17-50" href="#__codelineno-17-50"></a><span class="w">        </span><span class="n">time_tick_day</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">day</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-gdscript highlight"><span class="filename">day_night_panel.gd</span><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="w">    </span><span class="k">extends</span><span class="w"> </span><span class="n">Control</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="w">    </span><span class="err">@</span><span class="k">onready</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">day_label</span><span class="p">:</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">DayPanel</span><span class="o">/</span><span class="n">MarginContainer</span><span class="o">/</span><span class="n">DayLabel</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="w">    </span><span class="err">@</span><span class="k">onready</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">time_label</span><span class="p">:</span><span class="w"> </span><span class="n">Label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">TimePanel</span><span class="o">/</span><span class="n">MarginContainer</span><span class="o">/</span><span class="n">TimeLabel</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="w">    </span><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">normal_speed</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="w">    </span><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">fast_speed</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="w">    </span><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">light_speed</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">300</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="w">    </span><span class="k">func</span><span class="w"> </span><span class="n">_ready</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="w">        </span><span class="n">DayAndNightCycleManager</span><span class="o">.</span><span class="n">time_tick</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">on_time_tick</span><span class="p">)</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="w">        </span><span class="n">DayAndNightCycleManager</span><span class="o">.</span><span class="n">game_speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">normal_speed</span>
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a>
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="w">    </span><span class="k">func</span><span class="w"> </span><span class="n">on_time_tick</span><span class="p">(</span><span class="n">day</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">,</span><span class="w"> </span><span class="n">hour</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">,</span><span class="w"> </span><span class="n">minute</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="w">        </span><span class="n">day_label</span><span class="o">.</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Day "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">day</span><span class="p">)</span>
</span><span id="__span-18-16"><a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="w">        </span><span class="n">time_label</span><span class="o">.</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"</span><span class="si">%02d</span><span class="s2">:</span><span class="si">%02d</span><span class="s2">"</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">[</span><span class="n">hour</span><span class="p">,</span><span class="w"> </span><span class="n">minute</span><span class="p">]</span>
</span><span id="__span-18-17"><a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a>
</span><span id="__span-18-18"><a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a>
</span><span id="__span-18-19"><a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a><span class="w">    </span><span class="k">func</span><span class="w"> </span><span class="n">_on_normal_spd_button_pressed</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-18-20"><a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a><span class="w">        </span><span class="n">DayAndNightCycleManager</span><span class="o">.</span><span class="n">game_speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">normal_speed</span>
</span><span id="__span-18-21"><a id="__codelineno-18-21" name="__codelineno-18-21" href="#__codelineno-18-21"></a>
</span><span id="__span-18-22"><a id="__codelineno-18-22" name="__codelineno-18-22" href="#__codelineno-18-22"></a>
</span><span id="__span-18-23"><a id="__codelineno-18-23" name="__codelineno-18-23" href="#__codelineno-18-23"></a><span class="w">    </span><span class="k">func</span><span class="w"> </span><span class="n">_on_fast_spd_button_pressed</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-18-24"><a id="__codelineno-18-24" name="__codelineno-18-24" href="#__codelineno-18-24"></a><span class="w">        </span><span class="n">DayAndNightCycleManager</span><span class="o">.</span><span class="n">game_speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fast_speed</span>
</span><span id="__span-18-25"><a id="__codelineno-18-25" name="__codelineno-18-25" href="#__codelineno-18-25"></a>
</span><span id="__span-18-26"><a id="__codelineno-18-26" name="__codelineno-18-26" href="#__codelineno-18-26"></a>
</span><span id="__span-18-27"><a id="__codelineno-18-27" name="__codelineno-18-27" href="#__codelineno-18-27"></a><span class="w">    </span><span class="k">func</span><span class="w"> </span><span class="n">_on_light_spd_button_pressed</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-18-28"><a id="__codelineno-18-28" name="__codelineno-18-28" href="#__codelineno-18-28"></a><span class="w">        </span><span class="n">DayAndNightCycleManager</span><span class="o">.</span><span class="n">game_speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">light_speed</span>
</span></code></pre></div>
</details>
<h3 id="adding-farming-to-the-farming-sim">Adding Farming to the Farming Sim</h3>
<h5 id="161224">16/12/24</h5>
<p><a class="glightbox" href="https://drive.google.com/thumbnail?id=1A2m_e0o9qdQZwXZtt2kT1toNakuqsl0k&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1A2m_e0o9qdQZwXZtt2kT1toNakuqsl0k&amp;sz=s4000"></a></p>
<p>Completed the day-night cycle with a component to control the initial day and time that also adds a filter to the game screen with a custom gradient that changes over the course of a day, so as the day progresses the game appears to have a sunset, sunrise and night-time.</p>
<p>show time progressing video</p>
<p>Added some corn crops and gave them various particle effects for when they're actively being watered, wet, and mature. They use the same hurt component from the trees and rocks (listening for the watering can this time) to determine when they're being watered, and a new growth component controls their growth (WOAH NO WAY).</p>
<figure>
<p><a class="glightbox" href="https://drive.google.com/thumbnail?id=1Un0pvOcuGWD4PZXDtHZEikoEFBH_WXW4&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1Un0pvOcuGWD4PZXDtHZEikoEFBH_WXW4&amp;sz=s4000"></a><a class="glightbox" href="https://drive.google.com/thumbnail?id=1ne40QqzswvnXyISCloVU6XQlLMKhPazn&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1ne40QqzswvnXyISCloVU6XQlLMKhPazn&amp;sz=s4000"></a><a class="glightbox" href="https://drive.google.com/thumbnail?id=1wFmgGH3zccRMm1V4nidLPW81Z19tvX0F&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1wFmgGH3zccRMm1V4nidLPW81Z19tvX0F&amp;sz=s4000"></a></p>
<figcaption>
<p>Particle effects for freshly watered, watered and growing crops.</p>
</figcaption>
</figure>
<p>They're a bit buggy at present, and I don't particularly like how the tutorial handles crops. As it stands, when they're watered once they don't ever have to be watered again, but the wet particles disappear after a while so you can't tell which crops are watered. They will "harvest" themselves automatically after a day, which leaves the player with not much to actually do, and gives the impression the goods are just sitting on the ground being nibbled on by bugs all night. </p>
<p>Additionally, the final harvested stage, despite looking like the item, actually isn't one and is uncollectable. They also look kinda boring when they just pop into the next growth stage, and the way the growth cycle is done means that even with a growth length of 5 days for the 5 visible stages, the sprites don't update predictably, so two crops that look the same may be harvested on different days. There's a lot to fix, but I'll just move on for now.</p>
<h5 id="181224">18/12/24</h5>
<p><a class="glightbox" href="https://drive.google.com/thumbnail?id=1G2XKibDUwmF2twZgEnfXn8tQaCTUDx3D&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1G2XKibDUwmF2twZgEnfXn8tQaCTUDx3D&amp;sz=s4000"></a></p>
<p>Finished the crops part of the tutorial, adding some tomatoes that work the same as the corn, then moving back to Y-sorting for a bit to add different origin points for the various tiles and objects like crops, so they sort from a point that looks believable for their sprite.</p>
<p>show y sorting</p>
<p>Added a new terrain for tilled dirt and started work on a script and component that will let the player add farmland by using the hoe on nearby grass tiles.</p>
<h5 id="060125">06/01/25</h5>
<p>Fixed a visual issue where tomatoes specifically would be Eternally Wet because it looked weird (even if I dislike not knowing which crops are watered...), turns out I forgot to connect a signal so they ignored the day ticking over. Also made it so that when a plant grows it emits the "maturity" particles for a short while so it's less boring. There's no internet right now, so I have to get silly with it. Tomorrow I will add subway surfers and family guy funny moments to the UI o7</p>
<h5 id="070125">07/01/25</h5>
<p>JUMPSCARE!!! It's a crops rework because I can't take it anymore. Crops now need to be watered every day, progressing one stage a day with each stage being directly correlated with a new sprite, and once they're mature they stop growing and wait to be harvested. On that note, I also added a new component specifically for harvesting crops (the hurt component is already being used for watering, and I'd rather not mess with the existing function too much and hurt my brain, so a new component it is), so now the player can use the hoe to harvest crops when they're mature. Added a damage component and a new harvesting function as well, so that prior to crop maturity, the player can dig up crops and have them drop a collectable that returns the seeds used, with some cute lil digging dirt particles to go with it.</p>
<p><a class="glightbox" href="https://drive.google.com/thumbnail?id=1EbfjDVebSS0IcgkWQYwz4FSRyJnpByN1&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1EbfjDVebSS0IcgkWQYwz4FSRyJnpByN1&amp;sz=s4000"></a> <a class="glightbox" href="https://drive.google.com/thumbnail?id=1jk-XvYqRtJW2QxLql0eHDhYsroXihtAL&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1jk-XvYqRtJW2QxLql0eHDhYsroXihtAL&amp;sz=s4000"></a></p>
<details class="example">
<summary>Growth cycle component and harvest component</summary>
<div class="language-gdscript highlight"><span class="filename">harvest_component.gd</span><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="k">class_name</span><span class="w"> </span><span class="n">HarvestComponent</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="k">extends</span><span class="w"> </span><span class="n">Area2D</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="k">tool</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">Tools</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">Tools</span><span class="o">.</span><span class="n">None</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="k">signal</span><span class="w"> </span><span class="n">harvest</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_area_entered</span><span class="p">(</span><span class="n">area</span><span class="p">:</span><span class="w"> </span><span class="n">Area2D</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">hit_component</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">area</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">HitComponent</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="k">tool</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">hit_component</span><span class="o">.</span><span class="n">current_tool</span><span class="p">:</span>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="w">        </span><span class="n">harvest</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">hit_component</span><span class="o">.</span><span class="n">hit_damage</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-gdscript highlight"><span class="filename">growth_cycle_component.gd</span><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="k">class_name</span><span class="w"> </span><span class="n">GrowthCycleComponent</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="k">extends</span><span class="w"> </span><span class="n">Node</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">current_growth_state</span><span class="p">:</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">GrowthStates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">GrowthStates</span><span class="o">.</span><span class="n">Sprout</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="err">@</span><span class="n">export_range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">365</span><span class="p">)</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">days_until_harvest</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="k">signal</span><span class="w"> </span><span class="n">crop_maturity</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="k">signal</span><span class="w"> </span><span class="n">crop_harvesting</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="k">var</span><span class="w"> </span><span class="n">is_watered</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="k">var</span><span class="w"> </span><span class="n">growth_days</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="k">func</span><span class="w"> </span><span class="n">_ready</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a><span class="w">    </span><span class="n">DayAndNightCycleManager</span><span class="o">.</span><span class="n">time_tick_day</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">on_time_tick_day</span><span class="p">)</span>
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a><span class="k">func</span><span class="w"> </span><span class="n">on_time_tick_day</span><span class="p">(</span><span class="n">day</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">is_watered</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">current_growth_state</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">GrowthStates</span><span class="o">.</span><span class="n">Mature</span><span class="p">:</span>
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a><span class="w">        </span><span class="n">growth_days</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a><span class="w">        </span><span class="n">current_growth_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">growth_days</span>
</span><span id="__span-20-20"><a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a><span class="w">        </span><span class="nb">print</span><span class="p">(</span><span class="s2">"Current growth state: "</span><span class="p">,</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">GrowthStates</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="n">current_growth_state</span><span class="p">])</span>
</span><span id="__span-20-21"><a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a>
</span><span id="__span-20-22"><a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a><span class="w">    </span><span class="c1">#if current_growth_state == DataTypes.GrowthStates.Mature:</span>
</span><span id="__span-20-23"><a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a><span class="w">        </span><span class="c1">#growth_days += 1</span>
</span><span id="__span-20-24"><a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a>
</span><span id="__span-20-25"><a id="__codelineno-20-25" name="__codelineno-20-25" href="#__codelineno-20-25"></a>
</span><span id="__span-20-26"><a id="__codelineno-20-26" name="__codelineno-20-26" href="#__codelineno-20-26"></a>
</span><span id="__span-20-27"><a id="__codelineno-20-27" name="__codelineno-20-27" href="#__codelineno-20-27"></a><span class="k">func</span><span class="w"> </span><span class="n">growth_states</span><span class="p">(</span><span class="n">growth_days</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">):</span>
</span><span id="__span-20-28"><a id="__codelineno-20-28" name="__codelineno-20-28" href="#__codelineno-20-28"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">current_growth_state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">GrowthStates</span><span class="o">.</span><span class="n">Mature</span><span class="p">:</span>
</span><span id="__span-20-29"><a id="__codelineno-20-29" name="__codelineno-20-29" href="#__codelineno-20-29"></a><span class="w">        </span><span class="k">return</span>
</span><span id="__span-20-30"><a id="__codelineno-20-30" name="__codelineno-20-30" href="#__codelineno-20-30"></a>
</span><span id="__span-20-31"><a id="__codelineno-20-31" name="__codelineno-20-31" href="#__codelineno-20-31"></a><span class="w">    </span><span class="n">current_growth_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">growth_days</span>
</span><span id="__span-20-32"><a id="__codelineno-20-32" name="__codelineno-20-32" href="#__codelineno-20-32"></a><span class="w">    </span><span class="nb">print</span><span class="p">(</span><span class="s2">"Current growth state: "</span><span class="p">,</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">GrowthStates</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="n">current_growth_state</span><span class="p">])</span>
</span><span id="__span-20-33"><a id="__codelineno-20-33" name="__codelineno-20-33" href="#__codelineno-20-33"></a>
</span><span id="__span-20-34"><a id="__codelineno-20-34" name="__codelineno-20-34" href="#__codelineno-20-34"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">current_growth_state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">GrowthStates</span><span class="o">.</span><span class="n">Mature</span><span class="p">:</span>
</span><span id="__span-20-35"><a id="__codelineno-20-35" name="__codelineno-20-35" href="#__codelineno-20-35"></a><span class="w">        </span><span class="n">crop_maturity</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
</span><span id="__span-20-36"><a id="__codelineno-20-36" name="__codelineno-20-36" href="#__codelineno-20-36"></a>
</span><span id="__span-20-37"><a id="__codelineno-20-37" name="__codelineno-20-37" href="#__codelineno-20-37"></a><span class="k">func</span><span class="w"> </span><span class="n">get_current_growth_state</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">GrowthStates</span><span class="p">:</span>
</span><span id="__span-20-38"><a id="__codelineno-20-38" name="__codelineno-20-38" href="#__codelineno-20-38"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">current_growth_state</span>
</span></code></pre></div>
</details>
<details class="example">
<summary>Actual crop script. It's in a separate admonition for a reason.</summary>
<div class="language-gdscript highlight"><span class="filename">corn.gd</span><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="k">extends</span><span class="w"> </span><span class="n">Node2D</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="k">var</span><span class="w"> </span><span class="n">harvest_scene</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">preload</span><span class="p">(</span><span class="s2">"res://scenes/objects/plants/corn_harvest.tscn"</span><span class="p">)</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="k">var</span><span class="w"> </span><span class="n">seeds_scene</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">preload</span><span class="p">(</span><span class="s2">"res://scenes/objects/plants/corn_seeds.tscn"</span><span class="p">)</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="err">@</span><span class="k">onready</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">sprite_2d</span><span class="p">:</span><span class="w"> </span><span class="n">Sprite2D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">Sprite2D</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="err">@</span><span class="k">onready</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">watering_particles</span><span class="p">:</span><span class="w"> </span><span class="n">GPUParticles2D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">WateringParticles</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="err">@</span><span class="k">onready</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">wet_particles</span><span class="p">:</span><span class="w"> </span><span class="n">GPUParticles2D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">WetParticles</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="err">@</span><span class="k">onready</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">growing_particles</span><span class="p">:</span><span class="w"> </span><span class="n">GPUParticles2D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">GrowingParticles</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="err">@</span><span class="k">onready</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">growth_cycle_component</span><span class="p">:</span><span class="w"> </span><span class="n">GrowthCycleComponent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">GrowthCycleComponent</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="err">@</span><span class="k">onready</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">hurt_component</span><span class="p">:</span><span class="w"> </span><span class="n">HurtComponent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">HurtComponent</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="err">@</span><span class="k">onready</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">harvest_component</span><span class="p">:</span><span class="w"> </span><span class="n">HarvestComponent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">HarvestComponent</span>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="err">@</span><span class="k">onready</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">damage_component</span><span class="p">:</span><span class="w"> </span><span class="n">DamageComponent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">DamageComponent</span>
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="err">@</span><span class="k">onready</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">digging_particles</span><span class="p">:</span><span class="w"> </span><span class="n">GPUParticles2D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">DiggingParticles</span>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">cell</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">Vector2</span>
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a>
</span><span id="__span-21-17"><a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a><span class="k">var</span><span class="w"> </span><span class="n">growth_state</span><span class="p">:</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">GrowthStates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">GrowthStates</span><span class="o">.</span><span class="n">Seed</span>
</span><span id="__span-21-18"><a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a>
</span><span id="__span-21-19"><a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a><span class="k">var</span><span class="w"> </span><span class="n">collectable_name</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"cornseeds"</span>
</span><span id="__span-21-20"><a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a>
</span><span id="__span-21-21"><a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a><span class="k">func</span><span class="w"> </span><span class="n">_ready</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-21-22"><a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a><span class="w">    </span><span class="n">watering_particles</span><span class="o">.</span><span class="n">emitting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span>
</span><span id="__span-21-23"><a id="__codelineno-21-23" name="__codelineno-21-23" href="#__codelineno-21-23"></a><span class="w">    </span><span class="n">growing_particles</span><span class="o">.</span><span class="n">emitting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span>
</span><span id="__span-21-24"><a id="__codelineno-21-24" name="__codelineno-21-24" href="#__codelineno-21-24"></a><span class="w">    </span><span class="n">wet_particles</span><span class="o">.</span><span class="n">emitting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span>
</span><span id="__span-21-25"><a id="__codelineno-21-25" name="__codelineno-21-25" href="#__codelineno-21-25"></a>
</span><span id="__span-21-26"><a id="__codelineno-21-26" name="__codelineno-21-26" href="#__codelineno-21-26"></a><span class="w">    </span><span class="n">hurt_component</span><span class="o">.</span><span class="n">hurt</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">on_hurt</span><span class="p">)</span>
</span><span id="__span-21-27"><a id="__codelineno-21-27" name="__codelineno-21-27" href="#__codelineno-21-27"></a><span class="w">    </span><span class="n">harvest_component</span><span class="o">.</span><span class="n">harvest</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">on_harvest</span><span class="p">)</span>
</span><span id="__span-21-28"><a id="__codelineno-21-28" name="__codelineno-21-28" href="#__codelineno-21-28"></a><span class="w">    </span><span class="n">growth_cycle_component</span><span class="o">.</span><span class="n">crop_maturity</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">on_crop_maturity</span><span class="p">)</span>
</span><span id="__span-21-29"><a id="__codelineno-21-29" name="__codelineno-21-29" href="#__codelineno-21-29"></a><span class="w">    </span><span class="n">growth_cycle_component</span><span class="o">.</span><span class="n">crop_harvesting</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">on_crop_harvesting</span><span class="p">)</span>
</span><span id="__span-21-30"><a id="__codelineno-21-30" name="__codelineno-21-30" href="#__codelineno-21-30"></a><span class="w">    </span><span class="n">DayAndNightCycleManager</span><span class="o">.</span><span class="n">time_tick_day</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">on_time_tick_day</span><span class="p">)</span>
</span><span id="__span-21-31"><a id="__codelineno-21-31" name="__codelineno-21-31" href="#__codelineno-21-31"></a><span class="w">    </span><span class="n">damage_component</span><span class="o">.</span><span class="n">max_damage_reached</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">on_max_damage_reached</span><span class="p">)</span>
</span><span id="__span-21-32"><a id="__codelineno-21-32" name="__codelineno-21-32" href="#__codelineno-21-32"></a>
</span><span id="__span-21-33"><a id="__codelineno-21-33" name="__codelineno-21-33" href="#__codelineno-21-33"></a>
</span><span id="__span-21-34"><a id="__codelineno-21-34" name="__codelineno-21-34" href="#__codelineno-21-34"></a><span class="k">func</span><span class="w"> </span><span class="n">_process</span><span class="p">(</span><span class="n">delta</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-21-35"><a id="__codelineno-21-35" name="__codelineno-21-35" href="#__codelineno-21-35"></a><span class="w">    </span><span class="n">growth_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">growth_cycle_component</span><span class="o">.</span><span class="n">get_current_growth_state</span><span class="p">()</span>
</span><span id="__span-21-36"><a id="__codelineno-21-36" name="__codelineno-21-36" href="#__codelineno-21-36"></a><span class="w">    </span><span class="n">sprite_2d</span><span class="o">.</span><span class="n">frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">growth_state</span>
</span><span id="__span-21-37"><a id="__codelineno-21-37" name="__codelineno-21-37" href="#__codelineno-21-37"></a>
</span><span id="__span-21-38"><a id="__codelineno-21-38" name="__codelineno-21-38" href="#__codelineno-21-38"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">growth_state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">GrowthStates</span><span class="o">.</span><span class="n">Mature</span><span class="p">:</span>
</span><span id="__span-21-39"><a id="__codelineno-21-39" name="__codelineno-21-39" href="#__codelineno-21-39"></a><span class="w">        </span><span class="n">growing_particles</span><span class="o">.</span><span class="n">emitting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span>
</span><span id="__span-21-40"><a id="__codelineno-21-40" name="__codelineno-21-40" href="#__codelineno-21-40"></a>
</span><span id="__span-21-41"><a id="__codelineno-21-41" name="__codelineno-21-41" href="#__codelineno-21-41"></a><span class="k">func</span><span class="w"> </span><span class="n">on_harvest</span><span class="p">(</span><span class="n">hit_damage</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-21-42"><a id="__codelineno-21-42" name="__codelineno-21-42" href="#__codelineno-21-42"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">growth_state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">GrowthStates</span><span class="o">.</span><span class="n">Mature</span><span class="p">:</span>
</span><span id="__span-21-43"><a id="__codelineno-21-43" name="__codelineno-21-43" href="#__codelineno-21-43"></a><span class="w">        </span><span class="n">on_crop_harvesting</span><span class="p">()</span>
</span><span id="__span-21-44"><a id="__codelineno-21-44" name="__codelineno-21-44" href="#__codelineno-21-44"></a><span class="w">    </span><span class="k">else</span><span class="p">:</span>
</span><span id="__span-21-45"><a id="__codelineno-21-45" name="__codelineno-21-45" href="#__codelineno-21-45"></a><span class="w">        </span><span class="n">damage_component</span><span class="o">.</span><span class="n">apply_damage</span><span class="p">(</span><span class="n">hit_damage</span><span class="p">)</span>
</span><span id="__span-21-46"><a id="__codelineno-21-46" name="__codelineno-21-46" href="#__codelineno-21-46"></a><span class="w">        </span><span class="n">await</span><span class="w"> </span><span class="n">get_tree</span><span class="p">()</span><span class="o">.</span><span class="n">create_timer</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span><span class="o">.</span><span class="n">timeout</span>
</span><span id="__span-21-47"><a id="__codelineno-21-47" name="__codelineno-21-47" href="#__codelineno-21-47"></a><span class="w">        </span><span class="n">digging_particles</span><span class="o">.</span><span class="n">emitting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span>
</span><span id="__span-21-48"><a id="__codelineno-21-48" name="__codelineno-21-48" href="#__codelineno-21-48"></a>
</span><span id="__span-21-49"><a id="__codelineno-21-49" name="__codelineno-21-49" href="#__codelineno-21-49"></a><span class="k">func</span><span class="w"> </span><span class="n">on_max_damage_reached</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-21-50"><a id="__codelineno-21-50" name="__codelineno-21-50" href="#__codelineno-21-50"></a><span class="w">    </span><span class="n">await</span><span class="w"> </span><span class="n">get_tree</span><span class="p">()</span><span class="o">.</span><span class="n">create_timer</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span><span class="o">.</span><span class="n">timeout</span>
</span><span id="__span-21-51"><a id="__codelineno-21-51" name="__codelineno-21-51" href="#__codelineno-21-51"></a><span class="w">    </span><span class="n">call_deferred</span><span class="p">(</span><span class="s2">"add_seeds_scene"</span><span class="p">)</span>
</span><span id="__span-21-52"><a id="__codelineno-21-52" name="__codelineno-21-52" href="#__codelineno-21-52"></a><span class="w">    </span><span class="nb">print</span><span class="p">(</span><span class="s2">"max damage reached"</span><span class="p">)</span>
</span><span id="__span-21-53"><a id="__codelineno-21-53" name="__codelineno-21-53" href="#__codelineno-21-53"></a><span class="w">    </span><span class="n">queue_free</span><span class="p">()</span>
</span><span id="__span-21-54"><a id="__codelineno-21-54" name="__codelineno-21-54" href="#__codelineno-21-54"></a>
</span><span id="__span-21-55"><a id="__codelineno-21-55" name="__codelineno-21-55" href="#__codelineno-21-55"></a><span class="k">func</span><span class="w"> </span><span class="n">add_seeds_scene</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-21-56"><a id="__codelineno-21-56" name="__codelineno-21-56" href="#__codelineno-21-56"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">seeds_instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">seeds_scene</span><span class="o">.</span><span class="n">instantiate</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">Node2D</span>
</span><span id="__span-21-57"><a id="__codelineno-21-57" name="__codelineno-21-57" href="#__codelineno-21-57"></a><span class="w">    </span><span class="n">seeds_instance</span><span class="o">.</span><span class="n">global_position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">global_position</span>
</span><span id="__span-21-58"><a id="__codelineno-21-58" name="__codelineno-21-58" href="#__codelineno-21-58"></a><span class="w">    </span><span class="n">get_parent</span><span class="p">()</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">seeds_instance</span><span class="p">)</span>
</span><span id="__span-21-59"><a id="__codelineno-21-59" name="__codelineno-21-59" href="#__codelineno-21-59"></a>
</span><span id="__span-21-60"><a id="__codelineno-21-60" name="__codelineno-21-60" href="#__codelineno-21-60"></a><span class="k">func</span><span class="w"> </span><span class="n">add_harvest_scene</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-21-61"><a id="__codelineno-21-61" name="__codelineno-21-61" href="#__codelineno-21-61"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">harvest_instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">harvest_scene</span><span class="o">.</span><span class="n">instantiate</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">Node2D</span>
</span><span id="__span-21-62"><a id="__codelineno-21-62" name="__codelineno-21-62" href="#__codelineno-21-62"></a><span class="w">    </span><span class="n">harvest_instance</span><span class="o">.</span><span class="n">global_position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">global_position</span>
</span><span id="__span-21-63"><a id="__codelineno-21-63" name="__codelineno-21-63" href="#__codelineno-21-63"></a><span class="w">    </span><span class="n">get_parent</span><span class="p">()</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">harvest_instance</span><span class="p">)</span>
</span><span id="__span-21-64"><a id="__codelineno-21-64" name="__codelineno-21-64" href="#__codelineno-21-64"></a>
</span><span id="__span-21-65"><a id="__codelineno-21-65" name="__codelineno-21-65" href="#__codelineno-21-65"></a><span class="k">func</span><span class="w"> </span><span class="n">on_hurt</span><span class="p">(</span><span class="n">hit_damage</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-21-66"><a id="__codelineno-21-66" name="__codelineno-21-66" href="#__codelineno-21-66"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="n">growth_cycle_component</span><span class="o">.</span><span class="n">is_watered</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">growth_state</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">GrowthStates</span><span class="o">.</span><span class="n">Mature</span><span class="p">:</span>
</span><span id="__span-21-67"><a id="__codelineno-21-67" name="__codelineno-21-67" href="#__codelineno-21-67"></a><span class="w">        </span><span class="n">growth_cycle_component</span><span class="o">.</span><span class="n">is_watered</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span>
</span><span id="__span-21-68"><a id="__codelineno-21-68" name="__codelineno-21-68" href="#__codelineno-21-68"></a><span class="w">        </span><span class="n">watering_particles</span><span class="o">.</span><span class="n">emitting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span>
</span><span id="__span-21-69"><a id="__codelineno-21-69" name="__codelineno-21-69" href="#__codelineno-21-69"></a><span class="w">        </span><span class="n">await</span><span class="w"> </span><span class="n">get_tree</span><span class="p">()</span><span class="o">.</span><span class="n">create_timer</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span><span class="o">.</span><span class="n">timeout</span>
</span><span id="__span-21-70"><a id="__codelineno-21-70" name="__codelineno-21-70" href="#__codelineno-21-70"></a><span class="w">        </span><span class="n">watering_particles</span><span class="o">.</span><span class="n">emitting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span>
</span><span id="__span-21-71"><a id="__codelineno-21-71" name="__codelineno-21-71" href="#__codelineno-21-71"></a><span class="w">        </span><span class="n">wet_particles</span><span class="o">.</span><span class="n">emitting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span>
</span><span id="__span-21-72"><a id="__codelineno-21-72" name="__codelineno-21-72" href="#__codelineno-21-72"></a><span class="w">        </span><span class="n">await</span><span class="w"> </span><span class="n">get_tree</span><span class="p">()</span><span class="o">.</span><span class="n">create_timer</span><span class="p">(</span><span class="mf">20.0</span><span class="p">)</span><span class="o">.</span><span class="n">timeout</span>
</span><span id="__span-21-73"><a id="__codelineno-21-73" name="__codelineno-21-73" href="#__codelineno-21-73"></a><span class="w">        </span><span class="n">wet_particles</span><span class="o">.</span><span class="n">emitting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span>
</span><span id="__span-21-74"><a id="__codelineno-21-74" name="__codelineno-21-74" href="#__codelineno-21-74"></a>
</span><span id="__span-21-75"><a id="__codelineno-21-75" name="__codelineno-21-75" href="#__codelineno-21-75"></a><span class="k">func</span><span class="w"> </span><span class="n">on_time_tick_day</span><span class="p">(</span><span class="n">day</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-21-76"><a id="__codelineno-21-76" name="__codelineno-21-76" href="#__codelineno-21-76"></a><span class="w">    </span><span class="n">wet_particles</span><span class="o">.</span><span class="n">emitting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span>
</span><span id="__span-21-77"><a id="__codelineno-21-77" name="__codelineno-21-77" href="#__codelineno-21-77"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">growth_cycle_component</span><span class="o">.</span><span class="n">is_watered</span><span class="p">:</span>
</span><span id="__span-21-78"><a id="__codelineno-21-78" name="__codelineno-21-78" href="#__codelineno-21-78"></a><span class="w">        </span><span class="n">growing_particles</span><span class="o">.</span><span class="n">emitting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span>
</span><span id="__span-21-79"><a id="__codelineno-21-79" name="__codelineno-21-79" href="#__codelineno-21-79"></a><span class="w">        </span><span class="n">await</span><span class="w"> </span><span class="n">get_tree</span><span class="p">()</span><span class="o">.</span><span class="n">create_timer</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span><span class="o">.</span><span class="n">timeout</span>
</span><span id="__span-21-80"><a id="__codelineno-21-80" name="__codelineno-21-80" href="#__codelineno-21-80"></a><span class="w">        </span><span class="n">growing_particles</span><span class="o">.</span><span class="n">emitting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span>
</span><span id="__span-21-81"><a id="__codelineno-21-81" name="__codelineno-21-81" href="#__codelineno-21-81"></a><span class="w">        </span><span class="n">growth_cycle_component</span><span class="o">.</span><span class="n">is_watered</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span>
</span><span id="__span-21-82"><a id="__codelineno-21-82" name="__codelineno-21-82" href="#__codelineno-21-82"></a>
</span><span id="__span-21-83"><a id="__codelineno-21-83" name="__codelineno-21-83" href="#__codelineno-21-83"></a><span class="k">func</span><span class="w"> </span><span class="n">on_crop_maturity</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-21-84"><a id="__codelineno-21-84" name="__codelineno-21-84" href="#__codelineno-21-84"></a><span class="w">    </span><span class="n">growing_particles</span><span class="o">.</span><span class="n">emitting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span>
</span><span id="__span-21-85"><a id="__codelineno-21-85" name="__codelineno-21-85" href="#__codelineno-21-85"></a>
</span><span id="__span-21-86"><a id="__codelineno-21-86" name="__codelineno-21-86" href="#__codelineno-21-86"></a>
</span><span id="__span-21-87"><a id="__codelineno-21-87" name="__codelineno-21-87" href="#__codelineno-21-87"></a><span class="k">func</span><span class="w"> </span><span class="n">on_crop_harvesting</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-21-88"><a id="__codelineno-21-88" name="__codelineno-21-88" href="#__codelineno-21-88"></a><span class="w">    </span><span class="n">InventoryManager</span><span class="o">.</span><span class="n">add_collectable</span><span class="p">(</span><span class="n">collectable_name</span><span class="p">)</span>
</span><span id="__span-21-89"><a id="__codelineno-21-89" name="__codelineno-21-89" href="#__codelineno-21-89"></a><span class="w">    </span><span class="n">call_deferred</span><span class="p">(</span><span class="s2">"add_harvest_scene"</span><span class="p">)</span>
</span><span id="__span-21-90"><a id="__codelineno-21-90" name="__codelineno-21-90" href="#__codelineno-21-90"></a><span class="w">    </span><span class="n">queue_free</span><span class="p">()</span>
</span><span id="__span-21-91"><a id="__codelineno-21-91" name="__codelineno-21-91" href="#__codelineno-21-91"></a><span class="w">    </span><span class="n">await</span><span class="w"> </span><span class="n">get_tree</span><span class="p">()</span><span class="o">.</span><span class="n">create_timer</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
</span><span id="__span-21-92"><a id="__codelineno-21-92" name="__codelineno-21-92" href="#__codelineno-21-92"></a><span class="w">    </span><span class="n">growing_particles</span><span class="o">.</span><span class="n">emitting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span>
</span></code></pre></div>
</details>
<p>Added a seeds counter to the toolbar for each "seeds" tool, and making it so that when a crop is harvested the player gets some seeds back as well, so you don't slowly run out of seeds. Also tweaking the inventory manager global and collectable component so that items can give multiple of themselves, meaning a mature crop now gives you back 2 seeds instead of 1.</p>
<details class="example">
<summary>Changes to collectable items</summary>
<p>The inventory manager global just looks for a second argument with the number of items being added or removed. Pretty shrimple</p>
<p></p><div class="language-gdscript highlight"><span class="filename">inventory_manager.gd</span><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="k">func</span><span class="w"> </span><span class="n">add_collectable</span><span class="p">(</span><span class="n">collectable_name</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="p">,</span><span class="w"> </span><span class="n">collectable_count</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="w">    </span><span class="n">inventory</span><span class="o">.</span><span class="n">get_or_add</span><span class="p">(</span><span class="n">collectable_name</span><span class="p">)</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">inventory</span><span class="p">[</span><span class="n">collectable_name</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="p">:</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="w">        </span><span class="n">inventory</span><span class="p">[</span><span class="n">collectable_name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">collectable_count</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="w">    </span><span class="k">else</span><span class="p">:</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="w">        </span><span class="n">inventory</span><span class="p">[</span><span class="n">collectable_name</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">collectable_count</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="w">    </span><span class="n">inventory_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="k">func</span><span class="w"> </span><span class="n">remove_collectable</span><span class="p">(</span><span class="n">collectable_name</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="p">,</span><span class="w"> </span><span class="n">collectable_count</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">inventory</span><span class="p">[</span><span class="n">collectable_name</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="p">:</span>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="w">        </span><span class="n">inventory</span><span class="p">[</span><span class="n">collectable_name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a><span class="w">        </span><span class="k">return</span>
</span><span id="__span-22-14"><a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a><span class="w">    </span><span class="k">else</span><span class="p">:</span>
</span><span id="__span-22-15"><a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">inventory</span><span class="p">[</span><span class="n">collectable_name</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>
</span><span id="__span-22-16"><a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a><span class="w">            </span><span class="n">inventory</span><span class="p">[</span><span class="n">collectable_name</span><span class="p">]</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-22-17"><a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a>
</span><span id="__span-22-18"><a id="__codelineno-22-18" name="__codelineno-22-18" href="#__codelineno-22-18"></a><span class="w">    </span><span class="n">inventory_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
</span></code></pre></div>
Wherever an item needs to be added or removed from the player inventory, now it's possible (and necessary) to specify the count. The collectable component has this as an export variable so it can be easily changed for each item, but the crops just give you 2 seeds back when harvested because that's all they need to do.
<div class="language-gdscript highlight"><span class="filename">collectable_component.gd</span><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="k">class_name</span><span class="w"> </span><span class="n">CollectableComponent</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="k">extends</span><span class="w"> </span><span class="n">Area2D</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">collectable_name</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">String</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">collectable_count</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_body_entered</span><span class="p">(</span><span class="n">body</span><span class="p">:</span><span class="w"> </span><span class="n">Node2D</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">body</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">Player</span><span class="p">:</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="w">        </span><span class="n">InventoryManager</span><span class="o">.</span><span class="n">add_collectable</span><span class="p">(</span><span class="n">collectable_name</span><span class="p">,</span><span class="w"> </span><span class="n">collectable_count</span><span class="p">)</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="w">        </span><span class="nb">print</span><span class="p">(</span><span class="s2">"Collected:"</span><span class="p">,</span><span class="w"> </span><span class="n">collectable_name</span><span class="p">)</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="w">        </span><span class="n">get_parent</span><span class="p">()</span><span class="o">.</span><span class="n">queue_free</span><span class="p">()</span>
</span></code></pre></div>
<div class="language-gdscript highlight"><span class="filename">corn.gd</span><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="w">    </span><span class="k">func</span><span class="w"> </span><span class="n">on_crop_harvesting</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="w">        </span><span class="n">InventoryManager</span><span class="o">.</span><span class="n">add_collectable</span><span class="p">(</span><span class="n">collectable_name</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
</span></code></pre></div>
</details>
<h4 id="080125">08/01/25</h4>
<p>Some more QoL stuff. Due to the way the inputs were handled in the tutorial, clicking on any UI element would trigger an action (chopping, tilling etc) before, and I don't like that. For instance, if you're holding the hoe in front of a crop and go to switch to the watering can, the player will damage the crop first, which is annoying. To fix this I moved the clicking actions into <code>_unhandled_input()</code>, giving them a lower priority than before. Now, because the UI handles the inputs first when you click on it, it doesn't count ad an unhandled input so the player won't start jopping instead of. </p>
<p>There was a bit of a problem where the player would "double act", due to how I implemented the ability to transition into actions while walking (both scripts would detect the input as both scripts had the action transitions in them, and I've just moved them out of their state-specific functions so they're catching the input twice), and I used a quick fix of just adding a variable to each script that changed to true/false depending on whether their respective states are active, then tossing it onto the conditions for each action so that only one of the two main states can transition to an action at any time. That sounds convoluted but look it's literally just...</p>
<div class="language-gdscript highlight"><span class="filename">walk_state.gd</span><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="k">var</span><span class="w"> </span><span class="n">state</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="k">func</span><span class="w"> </span><span class="n">_unhandled_input</span><span class="p">(</span><span class="n">event</span><span class="p">:</span><span class="w"> </span><span class="n">InputEvent</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="w">    </span><span class="k">if</span><span class="w">  </span><span class="n">Input</span><span class="o">.</span><span class="n">is_action_just_pressed</span><span class="p">(</span><span class="s2">"hit"</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">player</span><span class="o">.</span><span class="n">current_tool</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">Tools</span><span class="o">.</span><span class="n">AxeWood</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="bp">true</span><span class="p">:</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="w">        </span><span class="n">transition</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">"Jopping"</span><span class="p">)</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="n">Input</span><span class="o">.</span><span class="n">is_action_just_pressed</span><span class="p">(</span><span class="s2">"hit"</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">player</span><span class="o">.</span><span class="n">current_tool</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">Tools</span><span class="o">.</span><span class="n">TillGround</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="bp">true</span><span class="p">:</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="w">        </span><span class="n">transition</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">"Tilling"</span><span class="p">)</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="n">Input</span><span class="o">.</span><span class="n">is_action_just_pressed</span><span class="p">(</span><span class="s2">"hit"</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">player</span><span class="o">.</span><span class="n">current_tool</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">Tools</span><span class="o">.</span><span class="n">WaterCrops</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="bp">true</span><span class="p">:</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="w">        </span><span class="n">transition</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">"Watering"</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="130125">13/01/25</h4>
<p>Continued work on the tilling/placing crops mechanic, finishing the scripts for the field cursor component and crops cursor component; they are <em>meant</em> to place down tiles, but it's not actually placing them for some reason.</p>
<h4 id="140125">14/01/25</h4>
<p>Found what was causing the issue, it was that the tilled soil layer didn't have a tileset assigned to it... Better that than a complicated bug I guess. Added some more tiles to the tilled soil terrain and fixed the bitmasks a bit, since it turns out the way they set it in the tutorial doesn't allow for certain shapes like a T shape... and I messed up the bitmask before. But now it's cool :) You can also un-till soil by pressing right click, and crops are only able to be planted on tilled ground so you gotta make little fields first to get planting.</p>
<p>I also made the seeds actually do something! So now you only plant crops if you have enough, and each time you plant a crop, the respective seeds go down by 1. That was actually surprisingly hard, there was a bug where if you started the game and tried to plant seeds without ever picking up or losing any it'd freak out because it was drawing from a null value. I fixed it by making the inventory manager "add" 0 to the items on start, so that if they're null they get assigned a value but if you already have some items it won't change that.</p>
<p>show planting/tilling in action xd</p>
<details class="example">
<summary>Planting/tilling mechanics</summary>
<div class="language-gdscript highlight"><span class="filename">field_cursor_component.gd</span><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="k">func</span><span class="w"> </span><span class="n">_unhandled_input</span><span class="p">(</span><span class="n">event</span><span class="p">:</span><span class="w"> </span><span class="n">InputEvent</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">event</span><span class="o">.</span><span class="n">is_action_pressed</span><span class="p">(</span><span class="s2">"hit"</span><span class="p">):</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">ToolManager</span><span class="o">.</span><span class="n">selected_tool</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">Tools</span><span class="o">.</span><span class="n">TillGround</span><span class="p">:</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="w">            </span><span class="n">get_cell_under_mouse</span><span class="p">()</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="w">            </span><span class="n">add_tilled_soil_cell</span><span class="p">()</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="n">event</span><span class="o">.</span><span class="n">is_action_pressed</span><span class="p">(</span><span class="s2">"release_tool"</span><span class="p">):</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">ToolManager</span><span class="o">.</span><span class="n">selected_tool</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">Tools</span><span class="o">.</span><span class="n">TillGround</span><span class="p">:</span>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a><span class="w">            </span><span class="n">get_cell_under_mouse</span><span class="p">()</span>
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a><span class="w">            </span><span class="n">remove_tilled_soil_cell</span><span class="p">()</span>
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>
</span><span id="__span-26-13"><a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a><span class="k">func</span><span class="w"> </span><span class="n">get_cell_under_mouse</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-26-14"><a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a><span class="w">    </span><span class="n">mouse_position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">grass_tilemap_layer</span><span class="o">.</span><span class="n">get_local_mouse_position</span><span class="p">()</span>
</span><span id="__span-26-15"><a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a><span class="w">    </span><span class="n">cell_position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">grass_tilemap_layer</span><span class="o">.</span><span class="n">local_to_map</span><span class="p">(</span><span class="n">mouse_position</span><span class="p">)</span>
</span><span id="__span-26-16"><a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a><span class="w">    </span><span class="n">cell_source_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">grass_tilemap_layer</span><span class="o">.</span><span class="n">get_cell_source_id</span><span class="p">(</span><span class="n">cell_position</span><span class="p">)</span>
</span><span id="__span-26-17"><a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a><span class="w">    </span><span class="n">local_cell_position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">grass_tilemap_layer</span><span class="o">.</span><span class="n">map_to_local</span><span class="p">(</span><span class="n">cell_position</span><span class="p">)</span>
</span><span id="__span-26-18"><a id="__codelineno-26-18" name="__codelineno-26-18" href="#__codelineno-26-18"></a><span class="w">    </span><span class="n">distance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">player</span><span class="o">.</span><span class="n">global_position</span><span class="o">.</span><span class="n">distance_to</span><span class="p">(</span><span class="n">local_cell_position</span><span class="p">)</span>
</span><span id="__span-26-19"><a id="__codelineno-26-19" name="__codelineno-26-19" href="#__codelineno-26-19"></a>
</span><span id="__span-26-20"><a id="__codelineno-26-20" name="__codelineno-26-20" href="#__codelineno-26-20"></a><span class="w">    </span><span class="nb">print</span><span class="p">(</span><span class="s2">"Mouse position: "</span><span class="p">,</span><span class="w"> </span><span class="n">mouse_position</span><span class="p">,</span><span class="w"> </span><span class="s2">" Cell position: "</span><span class="p">,</span><span class="w"> </span><span class="n">cell_position</span><span class="p">,</span><span class="w"> </span><span class="s2">" Cell source id: "</span><span class="p">,</span><span class="w"> </span><span class="n">cell_source_id</span><span class="p">)</span>
</span><span id="__span-26-21"><a id="__codelineno-26-21" name="__codelineno-26-21" href="#__codelineno-26-21"></a><span class="w">    </span><span class="c1">#print("Distance: ", distance)</span>
</span><span id="__span-26-22"><a id="__codelineno-26-22" name="__codelineno-26-22" href="#__codelineno-26-22"></a>
</span><span id="__span-26-23"><a id="__codelineno-26-23" name="__codelineno-26-23" href="#__codelineno-26-23"></a><span class="k">func</span><span class="w"> </span><span class="n">add_tilled_soil_cell</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-26-24"><a id="__codelineno-26-24" name="__codelineno-26-24" href="#__codelineno-26-24"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">distance</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">20.0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">cell_source_id</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="__span-26-25"><a id="__codelineno-26-25" name="__codelineno-26-25" href="#__codelineno-26-25"></a><span class="w">        </span><span class="n">tilled_soil_tilemap_layer</span><span class="o">.</span><span class="n">set_cells_terrain_connect</span><span class="p">([</span><span class="n">cell_position</span><span class="p">],</span><span class="w"> </span><span class="n">terrain_set</span><span class="p">,</span><span class="w"> </span><span class="n">terrain</span><span class="p">,</span><span class="w"> </span><span class="bp">true</span><span class="p">)</span>
</span><span id="__span-26-26"><a id="__codelineno-26-26" name="__codelineno-26-26" href="#__codelineno-26-26"></a><span class="w">        </span><span class="c1">#print("balls")</span>
</span><span id="__span-26-27"><a id="__codelineno-26-27" name="__codelineno-26-27" href="#__codelineno-26-27"></a>
</span><span id="__span-26-28"><a id="__codelineno-26-28" name="__codelineno-26-28" href="#__codelineno-26-28"></a><span class="k">func</span><span class="w"> </span><span class="n">remove_tilled_soil_cell</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-26-29"><a id="__codelineno-26-29" name="__codelineno-26-29" href="#__codelineno-26-29"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">distance</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">20.0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">cell_source_id</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="__span-26-30"><a id="__codelineno-26-30" name="__codelineno-26-30" href="#__codelineno-26-30"></a><span class="w">        </span><span class="n">tilled_soil_tilemap_layer</span><span class="o">.</span><span class="n">set_cells_terrain_connect</span><span class="p">([</span><span class="n">cell_position</span><span class="p">],</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="bp">true</span><span class="p">)</span>
</span></code></pre></div>
<p>The crops script is much the same, with the main difference being the conditions for planting crops VS tilling land and the fact that it adds the crop scenes as instances rather than just adding tiles to the tilemap.</p>
<div class="language-gdscript highlight"><span class="filename">crops_cursor_component.gd</span><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="k">func</span><span class="w"> </span><span class="n">add_crop</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">all_child_nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_parent</span><span class="p">()</span><span class="o">.</span><span class="n">find_child</span><span class="p">(</span><span class="s2">"CropFields"</span><span class="p">)</span><span class="o">.</span><span class="n">get_children</span><span class="p">()</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">is_cell_occupied</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">node</span><span class="p">:</span><span class="w"> </span><span class="n">Node2D</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">all_child_nodes</span><span class="p">:</span>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">node</span><span class="o">.</span><span class="n">cell</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">local_cell_position</span><span class="p">:</span>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="w">            </span><span class="n">is_cell_occupied</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">distance</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">20.0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">is_cell_occupied</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="bp">true</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">cell_source_id</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="w">        </span><span class="nb">print</span><span class="p">(</span><span class="s2">"attempting to plant on: "</span><span class="p">,</span><span class="w"> </span><span class="n">cell_source_id</span><span class="p">)</span>
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">ToolManager</span><span class="o">.</span><span class="n">selected_tool</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">Tools</span><span class="o">.</span><span class="n">PlantCorn</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">  </span><span class="n">InventoryManager</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">cornseeds</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="w">            </span><span class="k">var</span><span class="w"> </span><span class="n">corn_instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">corn_plant_scene</span><span class="o">.</span><span class="n">instantiate</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">Node2D</span>
</span><span id="__span-27-13"><a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a><span class="w">            </span><span class="n">corn_instance</span><span class="o">.</span><span class="n">global_position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_cell_position</span>
</span><span id="__span-27-14"><a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a><span class="w">            </span><span class="n">get_parent</span><span class="p">()</span><span class="o">.</span><span class="n">find_child</span><span class="p">(</span><span class="s2">"CropFields"</span><span class="p">)</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">corn_instance</span><span class="p">)</span>
</span><span id="__span-27-15"><a id="__codelineno-27-15" name="__codelineno-27-15" href="#__codelineno-27-15"></a><span class="w">            </span><span class="n">InventoryManager</span><span class="o">.</span><span class="n">remove_collectable</span><span class="p">(</span><span class="s2">"cornseeds"</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-27-16"><a id="__codelineno-27-16" name="__codelineno-27-16" href="#__codelineno-27-16"></a><span class="w">            </span><span class="nb">print</span><span class="p">(</span><span class="s2">"Planted corn"</span><span class="p">)</span>
</span><span id="__span-27-17"><a id="__codelineno-27-17" name="__codelineno-27-17" href="#__codelineno-27-17"></a>
</span><span id="__span-27-18"><a id="__codelineno-27-18" name="__codelineno-27-18" href="#__codelineno-27-18"></a><span class="w">        </span><span class="k">elif</span><span class="w"> </span><span class="n">ToolManager</span><span class="o">.</span><span class="n">selected_tool</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DataTypes</span><span class="o">.</span><span class="n">Tools</span><span class="o">.</span><span class="n">PlantTomato</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">InventoryManager</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">tomatoseeds</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>
</span><span id="__span-27-19"><a id="__codelineno-27-19" name="__codelineno-27-19" href="#__codelineno-27-19"></a><span class="w">            </span><span class="k">var</span><span class="w"> </span><span class="n">tomato_instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tomato_plant_scene</span><span class="o">.</span><span class="n">instantiate</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">Node2D</span>
</span><span id="__span-27-20"><a id="__codelineno-27-20" name="__codelineno-27-20" href="#__codelineno-27-20"></a><span class="w">            </span><span class="n">tomato_instance</span><span class="o">.</span><span class="n">global_position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_cell_position</span>
</span><span id="__span-27-21"><a id="__codelineno-27-21" name="__codelineno-27-21" href="#__codelineno-27-21"></a><span class="w">            </span><span class="n">get_parent</span><span class="p">()</span><span class="o">.</span><span class="n">find_child</span><span class="p">(</span><span class="s2">"CropFields"</span><span class="p">)</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">tomato_instance</span><span class="p">)</span>
</span><span id="__span-27-22"><a id="__codelineno-27-22" name="__codelineno-27-22" href="#__codelineno-27-22"></a><span class="w">            </span><span class="n">InventoryManager</span><span class="o">.</span><span class="n">remove_collectable</span><span class="p">(</span><span class="s2">"tomatoseeds"</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-27-23"><a id="__codelineno-27-23" name="__codelineno-27-23" href="#__codelineno-27-23"></a><span class="w">            </span><span class="nb">print</span><span class="p">(</span><span class="s2">"Planted tomatoes"</span><span class="p">)</span>
</span></code></pre></div>
<p>Oh and here's the bugfix, shrimple huh?</p>
<div class="language-gdscript highlight"><span class="filename">inventory_manager.gd</span><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="k">func</span><span class="w"> </span><span class="n">_ready</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="w">        </span><span class="n">add_collectable</span><span class="p">(</span><span class="s2">"tomatoseeds"</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="w">        </span><span class="n">add_collectable</span><span class="p">(</span><span class="s2">"cornseeds"</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="w">        </span><span class="n">inventory_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
</span></code></pre></div>
</details>
<p>Went back to ignoring the tutorial for a bit to make tools de-selectable, I just don't like that once you select a tool you must bear that cross forever. And being able to not have tools in your hands means maybe... one day... I can make it so you get to pet the cows and chickens... surely.........</p>
<details class="example">
<summary>Dumb tool fix yaaaaaay</summary>
<p>Each of the tool buttons now work as a toggle rather than an "on pressed" action. This bit is just for the axe, but it's the same for all of them.</p>
<div class="language-gdscript highlight"><span class="filename">tools_panel.gd</span><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_tool_axe_toggled</span><span class="p">(</span><span class="n">toggled_on</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="w">    </span><span class="n">ToolManager</span><span class="o">.</span><span class="n">select_tool</span><span class="p">(</span><span class="n">DataTypes</span><span class="o">.</span><span class="n">Tools</span><span class="o">.</span><span class="n">AxeWood</span><span class="p">)</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">toggled_on</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="bp">false</span><span class="p">:</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="w">        </span><span class="nb">print</span><span class="p">(</span><span class="s2">"deselected axe"</span><span class="p">)</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="hll"><span class="w">        </span><span class="n">deselect_tool</span><span class="p">()</span>
</span></span></code></pre></div>
<p>Toggling a tool button off will release every button from focus and set the current tool to none!</p>
<div class="language-gdscript highlight"><span class="filename">tools_panel.gd</span><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="k">func</span><span class="w"> </span><span class="n">deselect_tool</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="c1">#func _unhandled_input(event: InputEvent) -&gt; void:</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="w">    </span><span class="c1">#if event.is_action_pressed("release_tool"):</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="w">    </span><span class="n">ToolManager</span><span class="o">.</span><span class="n">select_tool</span><span class="p">(</span><span class="n">DataTypes</span><span class="o">.</span><span class="n">Tools</span><span class="o">.</span><span class="n">None</span><span class="p">)</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="w">    </span><span class="n">tool_axe</span><span class="o">.</span><span class="n">release_focus</span><span class="p">()</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="w">    </span><span class="n">tool_hoe</span><span class="o">.</span><span class="n">release_focus</span><span class="p">()</span>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="w">    </span><span class="n">tool_water</span><span class="o">.</span><span class="n">release_focus</span><span class="p">()</span>
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a><span class="w">    </span><span class="n">tool_corn</span><span class="o">.</span><span class="n">release_focus</span><span class="p">()</span>
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a><span class="w">    </span><span class="n">tool_tomato</span><span class="o">.</span><span class="n">release_focus</span><span class="p">()</span>
</span></code></pre></div>
</details>
<h3 id="saving-loading">Saving &amp; Loading</h3>
<h5 id="150125">15/01/25</h5>
<p>Starting to add a save system, using P as a shortcut to save and adding various components that will allow the game save certain parts of the scene, such as the player-modified tiles and objects such as farmland and crops. It's a lot of scripting basically...................................................................................</p>
<p>There's also a bug where you can plant multiple crops on one tile, and I tried to fix it but it hasn't worked. THERE IS NO BUG. LOOK AWAY I STILL HAVETN FIXED I-</p>
<h5 id="200125">20/01/25</h5>
<p>Apparently I forgot to add collision keeping the player from walking off the island this whole time, so I did that lol. Started making the actual main level; it's implemented in a way that would allow for easy swapping of levels, though that functionality won't be used since the game only needs one environment.</p>
<p>The chickens are stupid again. I don't know why.
Y sorting doesn't work when using the main game screen, and I also can't figure out where the culprit is.</p>
<p>Started making a menu screen, except all I got to do was add 1 (one) unstyled button. We'll get there chat</p>
<h5 id="210125">21/01/25</h5>
<p>Finished the title/pause menu, which you can bring up using <span class="keys"><kbd class="key-escape">Esc</kbd></span> . It has options to Start, Save and Quit which all technically work, save for some bugs relating to saving and loading. The background of the menu is just another game scene, but frozen by setting the process mode to disabled so it's just a static background. It's not decorated yet, but that'll come later.</p>
<h5 id="220125">22/01/25</h5>
<p>It's later. I decorated the menu background so it looks cute now! Yay!
<a class="glightbox" href="https://drive.google.com/thumbnail?id=1gUptbcAcMup_EhMJlq2hV8PkEGFBc4SI&amp;sz=s4000" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="https://drive.google.com/thumbnail?id=1gUptbcAcMup_EhMJlq2hV8PkEGFBc4SI&amp;sz=s4000"></a></p>
<h5 id="270125">27/01/25</h5>
<p>Added pausing functionality using get_tree().paused and setting the menu's process mode to always, so the entire game will freeze on pause except for the pause menu itself since the buttons still need to work, which is way easier than pausing things individually and potentially missing stuff. </p>
<details class="example">
<summary>Pause menu functionality</summary>
<div class="language-gdscript highlight"><span class="filename">game_manager.gd (global)</span><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="c1"># Pulls up the menu when ++esc++ is pressed</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="k">func</span><span class="w"> </span><span class="n">_unhandled_input</span><span class="p">(</span><span class="n">event</span><span class="p">:</span><span class="w"> </span><span class="n">InputEvent</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="hll"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">event</span><span class="o">.</span><span class="n">is_action_pressed</span><span class="p">(</span><span class="s2">"game_menu"</span><span class="p">):</span>
</span></span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="hll"><span class="w">        </span><span class="n">show_game_menu_screen</span><span class="p">()</span>
</span></span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a>
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a><span class="k">func</span><span class="w"> </span><span class="n">show_game_menu_screen</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a><span class="hll"><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">game_menu_screen_instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">game_menu_screen</span><span class="o">.</span><span class="n">instantiate</span><span class="p">()</span>
</span></span><span id="__span-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a><span class="w">    </span><span class="n">get_tree</span><span class="p">()</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">game_menu_screen_instance</span><span class="p">)</span>
</span><span id="__span-31-10"><a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a><span class="hll"><span class="w">    </span><span class="n">get_tree</span><span class="p">()</span><span class="o">.</span><span class="n">paused</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span>
</span></span></code></pre></div>
<div class="language-gdscript highlight"><span class="filename">game_menu_screen.gd</span><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="c1"># Sets the menu screen to always be processed, so it still functions while the game is paused</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="k">func</span><span class="w"> </span><span class="n">_ready</span><span class="p">():</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="hll"><span class="w">    </span><span class="n">process_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Node</span><span class="o">.</span><span class="n">PROCESS_MODE_ALWAYS</span>
</span></span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="c1"># These 3 functions all just connect their respective buttons to the scripts that handle their functions</span>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_start_game_button_pressed</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="w">    </span><span class="n">GameManager</span><span class="o">.</span><span class="n">start_game</span><span class="p">()</span>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="w">    </span><span class="n">queue_free</span><span class="p">()</span>
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="w">    </span><span class="n">get_tree</span><span class="p">()</span><span class="o">.</span><span class="n">paused</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span>
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a>
</span><span id="__span-32-11"><a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_save_game_button_pressed</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-32-12"><a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a><span class="w">    </span><span class="n">SaveGameManager</span><span class="o">.</span><span class="n">save_game</span><span class="p">()</span>
</span><span id="__span-32-13"><a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a>
</span><span id="__span-32-14"><a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a><span class="k">func</span><span class="w"> </span><span class="n">_on_quit_game_button_pressed</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-32-15"><a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a><span class="w">    </span><span class="n">GameManager</span><span class="o">.</span><span class="n">exit_game</span><span class="p">()</span>
</span></code></pre></div>
</details>
<p>Saving and loading now properly works on main-game scenes, so I can go over the scripts now (later lmao)</p>
<details class="example">
<summary>Saving &amp; loading functionality</summary>
<div class="language-gdscript highlight"><span class="filename">game_manager.gd (global)</span><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="c1"># Sets up the game and tells the other globals to load the base scene + any saved parts</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="c1"># Also sets a variable that allows the player to save now that there's a game to save</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="k">func</span><span class="w"> </span><span class="n">start_game</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="w">    </span><span class="n">SceneManager</span><span class="o">.</span><span class="n">load_main_scene_container</span><span class="p">()</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="w">    </span><span class="n">SceneManager</span><span class="o">.</span><span class="n">load_level</span><span class="p">(</span><span class="s2">"Level1"</span><span class="p">)</span>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="w">    </span><span class="n">SaveGameManager</span><span class="o">.</span><span class="n">load_game</span><span class="p">()</span>
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a><span class="w">    </span><span class="n">SaveGameManager</span><span class="o">.</span><span class="n">allow_save_game</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span>
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a>
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a><span class="c1"># Quits the game (NO WAY!)</span>
</span><span id="__span-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a><span class="k">func</span><span class="w"> </span><span class="n">exit_game</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-33-11"><a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a><span class="w">    </span><span class="n">get_tree</span><span class="p">()</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</span></code></pre></div>
<div class="language-gdscript highlight"><span class="filename">save_game_manager.gd (global)</span><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="k">extends</span><span class="w"> </span><span class="n">Node</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="k">var</span><span class="w"> </span><span class="n">allow_save_game</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="c1"># Lets the player save with just the key shortcut</span>
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a><span class="k">func</span><span class="w"> </span><span class="n">_unhandled_input</span><span class="p">(</span><span class="n">event</span><span class="p">:</span><span class="w"> </span><span class="n">InputEvent</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">event</span><span class="o">.</span><span class="n">is_action_pressed</span><span class="p">(</span><span class="s2">"save_game"</span><span class="p">):</span>
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="w">        </span><span class="n">save_game</span><span class="p">()</span>
</span><span id="__span-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a>
</span><span id="__span-34-10"><a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a><span class="c1"># Tells the save level data component in the scene to... save the level data. Mindblowing</span>
</span><span id="__span-34-11"><a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a><span class="k">func</span><span class="w"> </span><span class="n">save_game</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-34-12"><a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">save_level_data_component</span><span class="p">:</span><span class="w"> </span><span class="n">SaveLevelDataComponent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_tree</span><span class="p">()</span><span class="o">.</span><span class="n">get_first_node_in_group</span><span class="p">(</span><span class="s2">"save_level_data_component"</span><span class="p">)</span>
</span><span id="__span-34-13"><a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a>
</span><span id="__span-34-14"><a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">save_level_data_component</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="p">:</span>
</span><span id="__span-34-15"><a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a><span class="w">        </span><span class="n">save_level_data_component</span><span class="o">.</span><span class="n">save_game</span><span class="p">()</span>
</span><span id="__span-34-16"><a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a>
</span><span id="__span-34-17"><a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a><span class="c1"># Tells the same component to load the data, only if there is any data to load</span>
</span><span id="__span-34-18"><a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a><span class="k">func</span><span class="w"> </span><span class="n">load_game</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-34-19"><a id="__codelineno-34-19" name="__codelineno-34-19" href="#__codelineno-34-19"></a><span class="w">    </span><span class="n">await</span><span class="w"> </span><span class="n">get_tree</span><span class="p">()</span><span class="o">.</span><span class="n">process_frame</span>
</span><span id="__span-34-20"><a id="__codelineno-34-20" name="__codelineno-34-20" href="#__codelineno-34-20"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">save_level_data_component</span><span class="p">:</span><span class="w"> </span><span class="n">SaveLevelDataComponent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_tree</span><span class="p">()</span><span class="o">.</span><span class="n">get_first_node_in_group</span><span class="p">(</span><span class="s2">"save_level_data_component"</span><span class="p">)</span>
</span><span id="__span-34-21"><a id="__codelineno-34-21" name="__codelineno-34-21" href="#__codelineno-34-21"></a>
</span><span id="__span-34-22"><a id="__codelineno-34-22" name="__codelineno-34-22" href="#__codelineno-34-22"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">save_level_data_component</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="p">:</span>
</span><span id="__span-34-23"><a id="__codelineno-34-23" name="__codelineno-34-23" href="#__codelineno-34-23"></a><span class="w">        </span><span class="n">save_level_data_component</span><span class="o">.</span><span class="n">load_game</span><span class="p">()</span>
</span></code></pre></div>
</details>
<details class="example">
<summary>Saving/loading components. (Mucho texto)</summary>
<div class="language-gdscript highlight"><span class="filename">save_data_component.gd</span><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="k">class_name</span><span class="w"> </span><span class="n">SaveDataComponent</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="k">extends</span><span class="w"> </span><span class="n">Node</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="err">@</span><span class="k">onready</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">parent_node</span><span class="p">:</span><span class="w"> </span><span class="n">Node2D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_parent</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">Node2D</span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="err">@</span><span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">save_data_resource</span><span class="p">:</span><span class="w"> </span><span class="n">Resource</span>
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a>
</span><span id="__span-35-8"><a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a><span class="k">func</span><span class="w"> </span><span class="n">_ready</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-35-9"><a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a><span class="w">    </span><span class="n">add_to_group</span><span class="p">(</span><span class="s2">"save_data_component"</span><span class="p">)</span>
</span><span id="__span-35-10"><a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a>
</span><span id="__span-35-11"><a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a>
</span><span id="__span-35-12"><a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a><span class="k">func</span><span class="w"> </span><span class="n">_save_data</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Resource</span><span class="p">:</span>
</span><span id="__span-35-13"><a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">parent_node</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="p">:</span>
</span><span id="__span-35-14"><a id="__codelineno-35-14" name="__codelineno-35-14" href="#__codelineno-35-14"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb nb-Type">null</span>
</span><span id="__span-35-15"><a id="__codelineno-35-15" name="__codelineno-35-15" href="#__codelineno-35-15"></a>
</span><span id="__span-35-16"><a id="__codelineno-35-16" name="__codelineno-35-16" href="#__codelineno-35-16"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">save_data_resource</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="p">:</span>
</span><span id="__span-35-17"><a id="__codelineno-35-17" name="__codelineno-35-17" href="#__codelineno-35-17"></a><span class="w">        </span><span class="n">push_error</span><span class="p">(</span><span class="s2">"save_data_resource:"</span><span class="p">,</span><span class="w"> </span><span class="n">save_data_resource</span><span class="p">,</span><span class="w"> </span><span class="n">parent_node</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="__span-35-18"><a id="__codelineno-35-18" name="__codelineno-35-18" href="#__codelineno-35-18"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb nb-Type">null</span>
</span><span id="__span-35-19"><a id="__codelineno-35-19" name="__codelineno-35-19" href="#__codelineno-35-19"></a>
</span><span id="__span-35-20"><a id="__codelineno-35-20" name="__codelineno-35-20" href="#__codelineno-35-20"></a><span class="w">    </span><span class="n">save_data_resource</span><span class="o">.</span><span class="n">_save_data</span><span class="p">(</span><span class="n">parent_node</span><span class="p">)</span>
</span><span id="__span-35-21"><a id="__codelineno-35-21" name="__codelineno-35-21" href="#__codelineno-35-21"></a>
</span><span id="__span-35-22"><a id="__codelineno-35-22" name="__codelineno-35-22" href="#__codelineno-35-22"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">save_data_resource</span>
</span></code></pre></div>
<div class="language-gdscript highlight"><span class="filename">save_level_data_component.gd</span><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="k">class_name</span><span class="w"> </span><span class="n">SaveLevelDataComponent</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="k">extends</span><span class="w"> </span><span class="n">Node</span>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="k">var</span><span class="w"> </span><span class="n">level_scene_name</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">String</span>
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="k">var</span><span class="w"> </span><span class="n">save_game_data_path</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"user://game_data/"</span>
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a><span class="k">var</span><span class="w"> </span><span class="n">save_file_name</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"save_</span><span class="si">%s</span><span class="s2">_game_data.tres"</span>
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a><span class="k">var</span><span class="w"> </span><span class="n">game_data_resource</span><span class="p">:</span><span class="w"> </span><span class="n">SaveGameDataResource</span>
</span><span id="__span-36-8"><a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a>
</span><span id="__span-36-9"><a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a>
</span><span id="__span-36-10"><a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a><span class="k">func</span><span class="w"> </span><span class="n">_ready</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-36-11"><a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a><span class="w">    </span><span class="n">add_to_group</span><span class="p">(</span><span class="s2">"save_level_data_component"</span><span class="p">)</span>
</span><span id="__span-36-12"><a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a><span class="w">    </span><span class="n">level_scene_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_parent</span><span class="p">()</span><span class="o">.</span><span class="n">name</span>
</span><span id="__span-36-13"><a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a>
</span><span id="__span-36-14"><a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a>
</span><span id="__span-36-15"><a id="__codelineno-36-15" name="__codelineno-36-15" href="#__codelineno-36-15"></a><span class="k">func</span><span class="w"> </span><span class="n">save_node_data</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-36-16"><a id="__codelineno-36-16" name="__codelineno-36-16" href="#__codelineno-36-16"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_tree</span><span class="p">()</span><span class="o">.</span><span class="n">get_nodes_in_group</span><span class="p">(</span><span class="s2">"save_data_component"</span><span class="p">)</span>
</span><span id="__span-36-17"><a id="__codelineno-36-17" name="__codelineno-36-17" href="#__codelineno-36-17"></a>
</span><span id="__span-36-18"><a id="__codelineno-36-18" name="__codelineno-36-18" href="#__codelineno-36-18"></a><span class="w">    </span><span class="n">game_data_resource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SaveGameDataResource</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
</span><span id="__span-36-19"><a id="__codelineno-36-19" name="__codelineno-36-19" href="#__codelineno-36-19"></a>
</span><span id="__span-36-20"><a id="__codelineno-36-20" name="__codelineno-36-20" href="#__codelineno-36-20"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="p">:</span>
</span><span id="__span-36-21"><a id="__codelineno-36-21" name="__codelineno-36-21" href="#__codelineno-36-21"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">node</span><span class="p">:</span><span class="w"> </span><span class="n">SaveDataComponent</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">nodes</span><span class="p">:</span>
</span><span id="__span-36-22"><a id="__codelineno-36-22" name="__codelineno-36-22" href="#__codelineno-36-22"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">SaveDataComponent</span><span class="p">:</span>
</span><span id="__span-36-23"><a id="__codelineno-36-23" name="__codelineno-36-23" href="#__codelineno-36-23"></a><span class="w">                </span><span class="k">var</span><span class="w"> </span><span class="n">save_data_resource</span><span class="p">:</span><span class="w"> </span><span class="n">NodeDataResource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">.</span><span class="n">_save_data</span><span class="p">()</span>
</span><span id="__span-36-24"><a id="__codelineno-36-24" name="__codelineno-36-24" href="#__codelineno-36-24"></a><span class="w">                </span><span class="k">var</span><span class="w"> </span><span class="n">save_final_resource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">save_data_resource</span><span class="o">.</span><span class="n">duplicate</span><span class="p">()</span>
</span><span id="__span-36-25"><a id="__codelineno-36-25" name="__codelineno-36-25" href="#__codelineno-36-25"></a><span class="w">                </span><span class="n">game_data_resource</span><span class="o">.</span><span class="n">save_data_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">save_final_resource</span><span class="p">)</span>
</span><span id="__span-36-26"><a id="__codelineno-36-26" name="__codelineno-36-26" href="#__codelineno-36-26"></a>
</span><span id="__span-36-27"><a id="__codelineno-36-27" name="__codelineno-36-27" href="#__codelineno-36-27"></a>
</span><span id="__span-36-28"><a id="__codelineno-36-28" name="__codelineno-36-28" href="#__codelineno-36-28"></a><span class="k">func</span><span class="w"> </span><span class="n">save_game</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-36-29"><a id="__codelineno-36-29" name="__codelineno-36-29" href="#__codelineno-36-29"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="n">DirAccess</span><span class="o">.</span><span class="n">dir_exists_absolute</span><span class="p">(</span><span class="n">save_game_data_path</span><span class="p">):</span>
</span><span id="__span-36-30"><a id="__codelineno-36-30" name="__codelineno-36-30" href="#__codelineno-36-30"></a><span class="w">        </span><span class="n">DirAccess</span><span class="o">.</span><span class="n">make_dir_absolute</span><span class="p">(</span><span class="n">save_game_data_path</span><span class="p">)</span>
</span><span id="__span-36-31"><a id="__codelineno-36-31" name="__codelineno-36-31" href="#__codelineno-36-31"></a>
</span><span id="__span-36-32"><a id="__codelineno-36-32" name="__codelineno-36-32" href="#__codelineno-36-32"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">level_save_file_name</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">save_file_name</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">level_scene_name</span>
</span><span id="__span-36-33"><a id="__codelineno-36-33" name="__codelineno-36-33" href="#__codelineno-36-33"></a>
</span><span id="__span-36-34"><a id="__codelineno-36-34" name="__codelineno-36-34" href="#__codelineno-36-34"></a><span class="w">    </span><span class="n">save_node_data</span><span class="p">()</span>
</span><span id="__span-36-35"><a id="__codelineno-36-35" name="__codelineno-36-35" href="#__codelineno-36-35"></a>
</span><span id="__span-36-36"><a id="__codelineno-36-36" name="__codelineno-36-36" href="#__codelineno-36-36"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ResourceSaver</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">game_data_resource</span><span class="p">,</span><span class="w"> </span><span class="n">save_game_data_path</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">level_save_file_name</span><span class="p">)</span>
</span><span id="__span-36-37"><a id="__codelineno-36-37" name="__codelineno-36-37" href="#__codelineno-36-37"></a><span class="w">    </span><span class="nb">print</span><span class="p">(</span><span class="s2">"save result:"</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">)</span>
</span><span id="__span-36-38"><a id="__codelineno-36-38" name="__codelineno-36-38" href="#__codelineno-36-38"></a>
</span><span id="__span-36-39"><a id="__codelineno-36-39" name="__codelineno-36-39" href="#__codelineno-36-39"></a>
</span><span id="__span-36-40"><a id="__codelineno-36-40" name="__codelineno-36-40" href="#__codelineno-36-40"></a><span class="k">func</span><span class="w"> </span><span class="n">load_game</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
</span><span id="__span-36-41"><a id="__codelineno-36-41" name="__codelineno-36-41" href="#__codelineno-36-41"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">level_save_file_name</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">save_file_name</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">level_scene_name</span>
</span><span id="__span-36-42"><a id="__codelineno-36-42" name="__codelineno-36-42" href="#__codelineno-36-42"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">save_game_path</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">save_game_data_path</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">level_save_file_name</span>
</span><span id="__span-36-43"><a id="__codelineno-36-43" name="__codelineno-36-43" href="#__codelineno-36-43"></a>
</span><span id="__span-36-44"><a id="__codelineno-36-44" name="__codelineno-36-44" href="#__codelineno-36-44"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="n">FileAccess</span><span class="o">.</span><span class="n">file_exists</span><span class="p">(</span><span class="n">save_game_path</span><span class="p">):</span>
</span><span id="__span-36-45"><a id="__codelineno-36-45" name="__codelineno-36-45" href="#__codelineno-36-45"></a><span class="w">        </span><span class="k">return</span>
</span><span id="__span-36-46"><a id="__codelineno-36-46" name="__codelineno-36-46" href="#__codelineno-36-46"></a>
</span><span id="__span-36-47"><a id="__codelineno-36-47" name="__codelineno-36-47" href="#__codelineno-36-47"></a><span class="w">    </span><span class="n">game_data_resource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ResourceLoader</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">save_game_path</span><span class="p">)</span>
</span><span id="__span-36-48"><a id="__codelineno-36-48" name="__codelineno-36-48" href="#__codelineno-36-48"></a>
</span><span id="__span-36-49"><a id="__codelineno-36-49" name="__codelineno-36-49" href="#__codelineno-36-49"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">game_data_resource</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="p">:</span>
</span><span id="__span-36-50"><a id="__codelineno-36-50" name="__codelineno-36-50" href="#__codelineno-36-50"></a><span class="w">        </span><span class="k">return</span>
</span><span id="__span-36-51"><a id="__codelineno-36-51" name="__codelineno-36-51" href="#__codelineno-36-51"></a>
</span><span id="__span-36-52"><a id="__codelineno-36-52" name="__codelineno-36-52" href="#__codelineno-36-52"></a><span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">root_node</span><span class="p">:</span><span class="w"> </span><span class="n">Window</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_tree</span><span class="p">()</span><span class="o">.</span><span class="n">root</span>
</span><span id="__span-36-53"><a id="__codelineno-36-53" name="__codelineno-36-53" href="#__codelineno-36-53"></a>
</span><span id="__span-36-54"><a id="__codelineno-36-54" name="__codelineno-36-54" href="#__codelineno-36-54"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">game_data_resource</span><span class="o">.</span><span class="n">save_data_nodes</span><span class="p">:</span>
</span><span id="__span-36-55"><a id="__codelineno-36-55" name="__codelineno-36-55" href="#__codelineno-36-55"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">Resource</span><span class="p">:</span>
</span><span id="__span-36-56"><a id="__codelineno-36-56" name="__codelineno-36-56" href="#__codelineno-36-56"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">NodeDataResource</span><span class="p">:</span>
</span><span id="__span-36-57"><a id="__codelineno-36-57" name="__codelineno-36-57" href="#__codelineno-36-57"></a><span class="w">                </span><span class="n">resource</span><span class="o">.</span><span class="n">_load_data</span><span class="p">(</span><span class="n">root_node</span><span class="p">)</span>
</span></code></pre></div>
</details>
<p>Also I secretly fixed logs accidentally being set to add 0 of themselves when collected (they were the first collectible so I glossed over them when adding collectable_count as a thing).</p>
<p>The game is basically done as far as the assignment is concerned, though I am putting off audio like my life depends on it because my headphones are too short :(</p></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.top", "mkdocs-video", "header.autohide", "content.tooltips", "content.code.copy", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>